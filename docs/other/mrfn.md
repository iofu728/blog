---
title: æµ…è°ˆå¤šè½®æ£€ç´¢å¼å¯¹è¯æœ€è¿‘çš„ä¸¤ç¯‡SOTA-ã€MRFNã€&ã€IMNã€
date: 2019-02-05 14:21:12
tags: [NLP, QA, Machine Learn]
description: MRFN IMN
---
> æ–°å¹´ç¬¬ä¸€å¤©æ›´åš æ˜¾å¾—å¾ˆæœ‰ `ä»ªå¼æ„Ÿï¼ˆç ´éŸ³~ï¼‰` ï¼ˆè™½ç„¶å·²ç»æ–­æ›´ä¸€ä¸ªæœˆäº† æ‚è„¸ï¼‰
> ç¥å„ä½`NLPer`, å„ä½`dalao` åœ¨æ–°çš„ä¸€å¹´é‡Œçµæ„Ÿçˆ†æ£š æŠ•çš„offerå…¨ä¸­ ä¸‡è‚†å¦‚æ„ æ–°å¹´ç‰å¿«

æ–°å¹´ç¬¬ä¸€å¤© æ—¥å¸¸ç½‘ä¸Šå†²æµª ç«Ÿç„¶å‘ç°`MRFN`ç»ˆäºè¢«æ”¾å‡ºæ¥äº† å•Š å•Š å•Š~~

è¿™ç¯‡è®ºæ–‡æˆ‘ä»å»å¹´åæœˆä¸€ç›´ç­‰åˆ°ç°åœ¨

åœ¨è¿™æœŸé—´ä¸­ä¸ä¹æœ‰Bertè¿™ç§ç¥å™¨çˆ†å‡ºæ¥

ä½†å¹¶æ²¡æœ‰æ‰“æ¶ˆæˆ‘å¯¹è¿™ç¯‡SOTAçš„æœŸå¾…

`IMN` åˆ™æ˜¯ä¸Šä¸ªæœˆä¸­ç§‘é™¢å‡ ä½åšå£«åœ¨arXivåœ¨çº¿å‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ ä¸»è¦æ˜¯è¢«æ•°æ®å“åäº† æœ‰ã€å‰å®³ğŸ™‡

ç²—ç²—çœ‹ å¯èƒ½è§‰å¾—è¿™ä¸¤ç¯‡æ–‡ç« æ²¡ä»€ä¹ˆå…³ç³» ä¸€ä¸ªæ˜¯å¤šç²’åº¦fusion ä¸€ä¸ªæ˜¯ç±»ä¼¼äºBertçš„æ·±å±‚æ¬¡ç½‘ç»œå¤„ç†

ä½†ä»”ç»†æ€è€ƒ IMN dot ä¹‹åçš„ç»“æ„ä¸`MRFN`çš„FLSæœ‰å¼‚æ›²åŒå·¥çš„ä½œç”¨ `ä¸è´Ÿè´£çš„çŒœæµ‹` FLSçš„è®¾è®¡æ€è·¯ä¼šæˆä¸ºä»Šåä¸€æ®µæ—¶é—´followçš„ç‚¹

PS: ä»¥ä¸Šä¸¤ç¯‡paper éƒ½æ‰¿è¯ºå¼€æºcode ~~(è™½ç„¶repositoryé‡Œé¢éƒ½æ²¡æœ‰codeğŸ˜‚)~~ ä¹‹åä¼šè·Ÿä¸€ä¸‹code çœ‹ä¸€ä¸‹å…·ä½“æ•ˆæœ

> æ¦‚æ‹¬ä¸€ä¸‹ MRFN
> 1. åœ¨åŸæ¥SMN DAM ä¸¤ç²’åº¦ åŸºç¡€ä¸Šæå‡ºä¸‰ç²’åº¦6ç§è¡¨ç¤º
> 2. æå‡ºå¤šè¡¨ç¤ºåŒ¹é…-åˆå¹¶(Matching-Aggregation)çš„ä¸‰ç§ç­–ç•¥
> 3. ä½¿ç”¨å¤§é‡å®éªŒéªŒè¯å„ä¸ªè¡¨ç¤ºçš„ä½œç”¨ï¼ŒéªŒè¯contextè½®æ¬¡ã€å¹³å‡å¯¹è¯é•¿åº¦å˜åŒ–æ—¶å„ä¸ªè¡¨ç¤ºçš„ä½œç”¨æƒ…å†µ
> 4. æå‡ºçš„å¤šè¡¨ç¤ºåŒ¹é…-åˆå¹¶ç­–ç•¥å¯æ¨å¹¿åˆ°å…¶ä»–æ¨¡å‹ å¹¶åœ¨SMNä¸­è¿›è¡Œè¯•éªŒ
> 5. æ¯”DAMå¿«1.9xçš„è®­ç»ƒé€Ÿåº¦
>
> IMN
> 1. EMbeddingå±‚åŠ å…¥character-EMbedding è§£å†³OOV
> 2. EMbeddingå±‚åæ¥ç±»ä¼¼ELMoæ€è·¯çš„BiLSTM(paperä¸­ è¿™ä¸ªç»“æ„æœ€work)
> 3. dotä¹‹ååšä¸¤ä¸ªç²’åº¦çš„åˆ†æ

## `MRFN`

> MRFN = Multi-Representation Fusion Network

`MRFN`æ˜¯ä¸¥ç¿è€å¸ˆç»„é‡Œé™¶é‡é˜³åšå£«ï¼Œå°å†°ç»„å¾ç²²å­¦é•¿ï¼Œæ­¦å¨dalaoå»å¹´çš„å·¥ä½œ è®ºæ–‡å‘è¡¨åœ¨`WSDM2019`ä¸Š

å…¨æ–‡çœ‹ä¸‹æ¥ åŒ…æ‹¬Motivationï¼Œå®éªŒè®¾è®¡éƒ½ç»™æˆ‘ä¸€ç§å¾ˆèˆ’æœçš„æ„Ÿè§‰ æ„Ÿè§‰ä¸€åˆ‡éƒ½é¡ºç†æˆç«  ä¸€æ°”å‘µæˆ

äº‹å®ä¸Š å»å¹´åæœˆåº• åœ¨`EMNLP2018`çš„tutorialä¸Šä¸¥è€å¸ˆå’Œæ­¦å¨dalaoå°±å·²ç»æŠŠ`MRFN`çš„ç»“æœç§€å‡ºæ¥äº†

ä¹‹åå¾å­¦é•¿å›æ¥åˆ†äº«çš„æ—¶å€™ä¹Ÿæåˆ°è¿™ç¯‡è®ºæ–‡ ä½†è®ºæ–‡ä¸€ç›´æ²¡æ”¾å‡ºæ¥

### `Motivation`

è¿™ç¯‡æ–‡ç« çš„Motivationæ˜¯å»ºç«‹åœ¨æœ€è¿‘å‡ å¹´å¤šè½®æ£€ç´¢å¼å¯¹è¯åŸºäºçš„é¢å‘äº¤äº’çš„æ€æƒ³

å›æƒ³ä¸€ä¸‹ä»Multi-viewå¼•å…¥äº¤äº’ï¼Œåˆ°SMNå®Œå…¨åŸºäºäº¤äº’ï¼Œå†åˆ°DAMå¤šå±‚äº¤äº’

äº¤äº’çš„ç²’åº¦è¶Šå¤šè¶Šworkå·²ç»æ˜¯å¤§å®¶çš„å…±è¯†äº†

ä½†å¦‚ä½•æ›´å¥½çš„è®¾è®¡å„ä¸ªç²’åº¦ä¹‹é—´çš„å±‚æ¬¡å…³ç³» å‡å°‘ä¸å¿…è¦çš„æ€§èƒ½æµªè´¹

ä½œè€…æå‡ºæŠŠç²’åº¦åˆ’åˆ†ä¸º`word`, `short-term`, `long-term`ä¸‰ä¸ªç²’åº¦6ç§è¡¨ç¤º
1. `Word`
    + `character EMbedding`: åˆ©ç”¨å­—ç¬¦çº§åˆ«çš„CNNï¼ˆn-gramï¼‰è§£å†³typos/OOVçš„é—®é¢˜
        - æ€è·¯å’Œ[å°å¤•dalaoæ€»ç»“çš„è°ƒå°fastTextçª—å£å¤§å°è§£å†³OOVæ€è·¯](https://www.zhihu.com/question/265357659/answer/578944550)ä¸€è‡´
    + `Word2Vec`: è¿™é‡Œå¾ˆç®€å•çš„ç”¨äº†word2Vec å¾ˆæ˜¾ç„¶ç”¨ELMo Bertç­‰ä¼šæœ‰æ›´å¥½çš„æ•ˆæœ å½“ç„¶æ•ˆç‡ä¸Šé¢å°±ä¸å¤ªåˆ’ç®—
2. `Contextual`
    + `Sequential`: å€Ÿç”¨`GRU`çš„ç»“æ„å®ç°å¥å­ä¸­é—´å­ä¸²ä¿¡æ¯çš„è·å–
        - RNNèƒ½ä¿ç•™çŸ­è·ç¦»è¯ä¹‹é—´çš„å…³ç³» ç›¸å¯¹äº`sub-sequential`
    + `Local`: åˆ©ç”¨`CNN`è·å–N-gramçš„ä¿¡æ¯
        - CNNä¸­å·ç§¯å’Œæ± åŒ– ç›¸å¯¹äºè·å–ä¸­å¿ƒè¯å‘¨å›´`N-gram`çš„ä¿¡æ¯
3. `Attention-based`
    + `self-Attention`
    + `cross-Attention`

### `Model`
ä½†æ€ä¹ˆæŠŠè¿™äº›ç²’åº¦æœ‰æ•ˆçš„èåˆåœ¨ä¸€èµ·

å›æƒ³ä¸€ä¸‹SMNåœ¨CNNä¹‹åæ‰å°†`word`å’Œ`short-term`ä¸¤ä¸ªç²’åº¦çš„ä¿¡æ¯èåˆåœ¨ä¸€èµ·

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549370813808-3b407478-88cc-484e-a105-31e9bec4c618.png)

å¾ˆè‡ªç„¶çš„æƒ³åˆ° å¦‚æœåœ¨ä¹‹å‰/ä¹‹ååšfuseæ•ˆæœä¼šæ€ä¹ˆæ ·ï¼Ÿ

è¿™ä¸ªæ€è·¯ å°±å¾ˆåƒ[NIPS14å¹´é‚£ç¯‡è®¨è®ºæ˜¯åº”è¯¥å…ˆdotè¿˜æ˜¯åº”è¯¥å…ˆåšCNNçš„paper](http://www.hangli-hl.com/uploads/3/1/6/8/3168008/hu-etal-nips2014.pdf)

ä½œè€…å°±æå‡ºå‰ä¸­åä¸‰ç§`fusion`ç­–ç•¥

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549370840387-18e191f1-c844-466f-936c-ae66e231d488.png)

å…¶ä¸­å·¦ä¾§æ˜¯ä¹‹å‰è®¾è®¡çš„6é’Ÿè¡¨ç¤º

`U`->`U*`çš„è¿‡ç¨‹æ˜¯ç®€å•çš„æŠŠå¤šä¸ªçŸ©é˜µæ‹¼æ¥æˆä¸€ä¸ªçŸ©é˜µ

$U^*_i \in R^{d^* \times n_i}(d^*=\sum d_k)$

è€Œ`fusion`åˆ™æ˜¯åˆ©ç”¨ç±»ä¼¼`CNN`çš„å…¬å¼

$t_{i,j}=f(\hat{e_{i,j}},\bar{e_{i,j}})=ReLU(W_p[(\hat{e_{i,j}}-\bar{e_{i,j}}) \odot \hat{e_{i,j}}-\bar{e_{i,j}});\hat{e_{i,j}} \odot \bar{e_{i,j}}]+b_p)$

å…¶ä¸­

$w_{j,k}^i=V_a^T tanh(W_a[\hat{e_{i,j}\oplus \hat{e_{r,k}}]+b_a})$

$\alpha_{j,k}^i=\frac{exp(\omega_{j,k}^i)}{\sum(exp(\omega_{j,k}^i))}$

$\bar{e_{i,j}}=\sum{\alpha_{j,k}^i}\hat{e_{r,k}}$

$\odot$ å°±æ˜¯Hadamard dot (æˆ–è€…å«element-wise multiplication)

ä¹‹åå°±è·Ÿä¸Š`GRU`å’Œ`MLR`å¾—åˆ°ç›¸åº”çš„scoreå€¼

### `Experiment`

æœ¬æ–‡åšäº†å¤§é‡çš„å®éªŒ ç¾¡æ…•MSRAæœ‰ç”¨ä¸å®Œçš„æœºå™¨ å‘œå‘œå‘œ

1. å…ˆæ˜¯å¯¹æ¯”ä¹‹å‰å­˜åœ¨çš„ä¸€äº›æ¨¡å‹

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549375167463-6165224b-a84d-473e-8fe9-fa55147fac9a.png)

å¯ä»¥çœ‹å‡º`FLS`æ•ˆæœæ¯”`DAM`æå‡æ¯”è¾ƒæ˜¾è‘— å³ä½¿æ˜¯ `FIS`åœ¨Dubboæ•°æ®é›†ä¸Šä¹Ÿæ¯”DAMç•¥å¾®å¥½ä¸€ç‚¹

2. ç„¶åè¿˜åšäº†æŠŠæ¨¡å‹ç»“æ„ä¸­å„ä¸ªéƒ¨åˆ†å»æ‰ä¹‹åçš„ä¸€äº›ç»“æœ

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549373911507-ed243c9b-3ec3-4774-8233-aa07ae943a50.png)

å¯ä»¥çœ‹å‡º`Contextual`ä¸¤ä¸ªéƒ¨åˆ†æ•ˆæœç•¥æœ‰é‡å å¯¼è‡´äº†å»é™¤å…¶ä¸€æ‰ç‚¹ä¸ä¼šå¤ªå¤š æ€»çš„æ¥è¯´`Contextual`åœ¨æ¨¡å‹ä¸­æç‚¹æœ€å¤§

3. è¿˜åšäº†æ¨¡å‹æ‹“å±•æ€§æ–¹é¢çš„å®éªŒ æŠŠ`fusion`ä¸‰ç­–ç•¥ç§»åˆ°`SMN`ä¹Ÿå¾—åˆ°äº†ä¸é”™çš„ç»“æœ

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549375170102-58cb3433-3ac6-41a9-96ab-2138301bee44.png)

4. æœ€åè¿˜æ¢ç©¶äº†å¤šè½®å¯¹è¯Contextè½®æ¬¡ å¯¹è¯é•¿åº¦å˜åŒ–æ—¶å„ä¸ªè¡¨ç¤ºçš„ä½œç”¨å æ¯”æƒ…å†µ

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549375166993-e660570b-56e8-4f44-83cc-114e1dac986b.png)

å…¨ç¯‡çœ‹ä¸‹æ¥ å¯¹äºä¸€ä¸ªåšç³»ç»Ÿå‡ºèº«çš„å‡ºèº«æ¥çœ‹ ååˆ†èˆ’æœ å¯ä»¥è¯´æ˜¯æ¯”è¾ƒ`Science` å¾—åˆ°çš„ç»“æœä¹Ÿæ¯”è¾ƒ`significantly`

## `IMN`

> IMN = Interactive Matching Network

ç›¸å¯¹è€Œè¨€ `IMN` è®ºæ–‡å†™å¾—æœ‰ç‚¹éšæ„ å–åå­—ä¹Ÿæœ‰ã€ğŸ˜¶(ä¸æ˜¯å–· åæ§½ä¸€ä¸‹)

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549375125045-08bf3e93-7918-45bd-bc71-625352895e1b.png)

åŒæ · IMNçš„ä½œè€…ä¹Ÿæƒ³åˆ°äº†ç”¨`character`æ¥å‡ç¼“OOVçš„é—®é¢˜

åˆ›æ–°ç‚¹åœ¨äº EMbeddingå±‚ä¹‹åç”¨äº†ä¸€ä¸ªç±»ä¼¼`ELMo`çš„å¤„ç†ç­–ç•¥ æ¥è·å–Sentenceä¹‹é—´çš„ä¿¡æ¯

~~ï¼ˆå½“ç„¶ å¦‚æœç°åœ¨æ¥åš ç”¨BertåšåŒæ ·çš„äº‹æƒ…å¯èƒ½ä¼šæ›´å¥½ï¼‰~~

é™¤äº†ä¸Šè¿°çš„ideaä¹‹å¤– ä½œè€…è¿˜åœ¨dotå®Œä¹‹ååˆ†æˆä¸¤ä¸ªç²’åº¦åšå¤„ç†

ä»”ç»†ä¸€æƒ³ è¿™å’ŒMRFNçš„FLSæœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ€è·¯ æŠŠfusionçš„è¿‡ç¨‹å¾€åæ¨è¿Ÿ

![image](https://cdn.nlark.com/yuque/0/2019/png/104214/1549375169785-e0698714-ccfd-4a8f-a94f-29fb5f117e90.png)

ç„¶åè¿™ä¸ªresultç¡®å®å‰å®³ `ym dalao`

## `References`
1. [Multi-Representation Fusion Network for Multi-turn Response Selection in Retrieval-based Chatbots. Chongyang Tao et al. WSDM2019.](https://dl.acm.org/ft_gateway.cfm?id=3290985&ftid=2038017&dwn=1&CFID=48199586&CFTOKEN=fd4f6dfb8820cbf2-214D0EB6-AEAD-530A-88B454E3E573F7AF)
2. [Interactive Matching Network for Multi-Turn Response Selection in Retrieval-Based Chatbots. Jia-Chen Gu et al. 2019](https://arxiv.org/pdf/1901.01824)

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"/>

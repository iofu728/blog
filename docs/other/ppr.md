---
pageClass: custom-page-class
---

# å¤§å›¾ä¸­å¦‚ä½•å¿«é€Ÿè®¡ç®—`PPR`

> ç»ˆäºå†™å®Œäº† èŠ±äº†å¿«ä¸€å‘¨ ç´¯ æ‹–å»¶ç—‡çš„æ— å¥ˆ
> ç„¶å å‘ç° çŸ¥è¯†ç‚¹å¥½å¤š å®³å•ª
> å›æƒ³ä¸€ä¸‹ ç°åœ¨MLé¢†åŸŸé€æ¸èµ°å‘äº¤å‰æ€åŠ¿ ä¸åº”è¯¥å†æ‹˜æ³¥äºä¸€ä¸ªå°æ–¹å‘
> è¿˜æ˜¯è¦å¤šå­¦ä¹ 
> å…³é”®è¯: `PPR` `TopPPR` `Alias Method` `Multi-armed Bandit`
> `æœ¬æ–‡é¢„è®¡éœ€è¦20-30min`

é¦–å…ˆæˆ‘ä»¬åº”è¯¥å¯¹[ä»€ä¹ˆæ˜¯PageRank](/other/pageranks.md)æœ‰äº†ä¸€å®šæ¦‚å¿µ æ²¡æœ‰çš„è¯è¯·ç‚¹ğŸ‘ˆ

$PR(u) =\alpha \sum\limits_{v \in N_{in}(u)}^N \dfrac{1}{N_{out}(v)}PR(v) + (1-\alpha) \dfrac{1}{n}$

$\vec{PR}^{l \cdot T}=\alpha ^l\vec{PR}^{0\cdot T}P^l+\dfrac{1-\alpha}{n}\vec{1}^T(\alpha^{l-1}\cdot P^{l-1}+\cdot \cdot \cdot+\alpha P + I)$

PageRankç›¸å¯¹äºç«™åœ¨ä¸Šå¸è§†è§’è¿›è¡Œè¯„ä»·æ‰€æœ‰èŠ‚ç‚¹çš„é‡è¦ç¨‹åº¦å€¼

å¿…é¡»éå†æ‰€æœ‰ç½‘ç»œä¸Šçš„èŠ‚ç‚¹æ‰èƒ½è¿›è¡Œè®¡ç®—

å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸çŸ¥é“äº’è”ç½‘æœ‰å¤šå¤§ ä¹Ÿæ²¡æ³•ä»å…¨å±€çš„è§†è§’è¯„ä»·æ‰€æœ‰èŠ‚ç‚¹

å½“ç„¶ä¹Ÿæ˜¯ä¸ºäº†æå‡ºæ›´ä¸ªæ€§åŒ–çš„è¯„ä»·æŒ‡æ ‡

äºæ˜¯å°±æœ‰å­¦è€…æå‡ºPPR

è·Ÿæˆ‘å¿µ `PPAP` `PPAP` `PPR`

> PPR = Personal Page Rank value

ä»¥ä¸ªäººèŠ‚ç‚¹è§’åº¦å‡ºå‘ è®¡ç®—PageRankå€¼

$PPR_s(u) =\alpha \sum\limits_{v \in N_{in}(u)}^N \dfrac{1}{N_{out}(v)}PPR_s(v) + (1-\alpha) \dfrac{1}{n}$

PPRçš„å€¼éƒ½æ˜¯åŸºäºæŸä¸€ä¸ªèŠ‚ç‚¹sçš„ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å¯¹PPRè¿›è¡Œç ”ç©¶

* ç»™å®šä¸€ä¸ªSource S, è¿”å›æ‰€æœ‰èŠ‚ç‚¹å…³äºsçš„PPRå€¼
* ç»™å®šä¸€ä¸ªSource S, è¿”å›Top-KèŠ‚ç‚¹å…³äºsçš„PPRå€¼
    + å½“ç„¶åœ¨ä¹‹å‰çš„ç ”ç©¶å½“ä¸­Top-Kå°±æ˜¯æŠŠæ‰€æœ‰èŠ‚ç‚¹çš„PPRå€¼è®¡ç®—ä¸€é ç„¶åå†  ç›´åˆ°å»å¹´å§ å—¯ï¼ˆæˆ‘ä»¬ç¨ååˆ†æï¼‰
    + å¯¹äºè¿™ç§é—®é¢˜ å¦‚æœPPRå€¼æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆå¯¹ä»–ä¼°è®¡è¯¯å·®è¾ƒå¤§ å°±ä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼ˆå½“ç„¶ä¸èƒ½è¯¯å·®åˆ°Top-Kï¼‰
    + å¾ˆæ˜¾ç„¶è¿™ç§æ›´å…·æœ‰ä»·å€¼

å½“ç„¶ åœ¨è®¡ç®—PPRçš„æ—¶å€™ è¿˜æ˜¯éœ€è¦è¿›è¡Œé€’å½’è®¡ç®—çš„

é€’å½’å°±éœ€è¦è¾¹ç•Œ

* $|\tilde{\pi}(s,t)-\pi(s,t)|\le\epsilon\pi(s,t)$

* $\pi(s,t)\le\delta$ (ä¸€èˆ¬è€Œè¨€ $\delta = O(1/n)$)

* ä¸¾ä¸ªæ —å­, åœ¨é€‰Top-3çš„æ—¶å€™

    $\pi(s,v_1)=0.45 ,\pi(s,v_2)=0.2, \pi(s,v_3)=0.18, \pi(s,v_4)=0.17, \epsilon=0.1, \delta=0.01$

    åœ¨$\tilde{\pi}(s,v_1)=0.45,\tilde{\pi}(s,v_2)=0.2, \tilde{\pi}(s,v_4)=0.18$æ—¶ï¼Œæœ‰

    $|\tilde{\pi}(s,v_4)-\pi(s,v_4)|\le0.1\pi(s,v_4), |\pi(s,v_4)-\pi(s,v_3)|\le0.1\pi(s,v_3)$åˆ†åˆ«ä¸ºæ”¶æ•›æ€§å’Œç›¸ä¼¼æ€§

    ä¸å†care top-Kåé¢çš„æ’åºå’Œå€¼æ˜¯å¦æ˜¯å¯¹çš„

å½“ç„¶PPRçš„æœ‰æå¼ºçš„å·¥ä¸šåº”ç”¨åœºæ™¯

æ¯”å¦‚è¯´é¹…å‚çš„ç‹ç‰Œæ¸¸æˆ-ç‹è€…è£è€€çš„å¥½å‹æ¨èå°±æ˜¯åŸºäºPPRçš„ ~~(ä¸€èˆ¬äººæˆ‘ä¸è·Ÿä»–è¯´)~~

Aå‚ä¸»è¥ä¸šåŠ¡TBçš„`ã€åƒäººåƒé¢ã€`ç®—æ³•

è¿˜æ¯”å¦‚è¯´å®ä½“æ¶ˆæ­§ ~~(æ¶ˆé™¤æ­§ä¹‰ æˆ‘ç¬¬ä¸€æ¬¡å¬è§è¿™ä¸ªåè¯çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼çš„)~~

è¿˜æœ‰ç¤¾äº¤ç½‘ç»œçš„å…³ç³»æŸ¥è¯¢ ç¾¡æ…• è¿™ä¹ˆå¥½æ‰¾å·¥ä½œçš„å®éªŒå®¤

å½“ç„¶PPRçš„è¿‘ä¼¼ä¼°è®¡ç®—æ³•æœ‰å¾ˆå¤š ä¸‹é¢å°±æ¥å¤§è‡´ä»‹ç»ä¸€ä¸‹ğŸ‘‡

## Monte Carlo Method
<p align="right">[Andersen et al. 2007]</p>

é‚£ä»€ä¹ˆæ˜¯è’™ç‰¹å¡æ´› ç®€å•æ¥è¯´ è’™ç‰¹å¡æ´›å°±æ˜¯ä¸€ç±»éšæœºç®—æ³•

ä¸€èˆ¬æŠŠè’™ç‰¹å¡æ´›å’Œæ‹‰æ–¯ç»´åŠ æ–¯æ”¾åœ¨ä¸€èµ·æ¯”è¾ƒ

* `è’™ç‰¹å¡ç½—`ç®—æ³•ï¼šé‡‡æ ·è¶Šå¤šï¼Œè¶Š**è¿‘ä¼¼**æœ€ä¼˜è§£
* `æ‹‰æ–¯ç»´åŠ æ–¯`ç®—æ³•ï¼šé‡‡æ ·è¶Šå¤šï¼Œè¶Š**æœ‰æœºä¼š**<u>æ‰¾åˆ°</u>æœ€ä¼˜è§£

ä¸¾ä¸ªå¾ˆç»å…¸çš„ğŸŒ°

* `è’™ç‰¹å¡æ´›`å°±æ˜¯: ä»100ä¸ªğŸsä¸­æŒ‘æœ€å¤§çš„ï¼Œæ‹¿ä¸€ä¸ªåœ¨æ‰‹ä¸Šï¼Œå†éšæœºæŒ‘ä¸€ä¸ªï¼Œé€‰äºŒè€…æœ€å¤§çš„ï¼Œé™¤ééå†å®Œæ¯•ï¼Œå¦åˆ™åªèƒ½ç»™å‡ºä¸€ä¸ª**è¿‘ä¼¼**æœ€ä¼˜è§£
* `æ‹‰æ–¯ç»´åŠ æ–¯`å°±æ˜¯: ä»100æŠŠğŸ”‘ä¸­æ‰¾åˆ°èƒ½å¼€é—¨çš„é’¥åŒ™ï¼Œä¸èƒ½ä¿è¯ä¸€å®šæ‰¾å¾—åˆ°æœ€ä¼˜è§£ï¼Œä½†æ‰¾åˆ°äº†è‚¯å®šæ˜¯æœ€ä¼˜è§£

é‚£ä¹ˆè¿™é‡Œçš„`MCç®—æ³•`å°±æ˜¯ä»¥éšæœºæ¸¸èµ°çš„æ¦‚ç‡ä¼°è®¡PPRå€¼ ~~(å…¶å®ç›¸åŒçš„æ–¹æ³•æˆ‘ä»¬åœ¨PageRankçš„è®¡ç®—ä¸­ä¹Ÿæåˆ°è¿‡)~~

é‚£ä¹ˆä¼°è®¡éƒ½æ˜¯ä¸€ä¸ªæ— åä¼°è®¡ æ¯æ¬¡Random walkéƒ½æ˜¯å¯¹æ‰€æœ‰ç‚¹çš„æ— åä¼°è®¡ï¼

ç›´è§‚ä¸Šæ„Ÿè§‰Random walkè¶Šå¤šä¼°è®¡çš„è¶Šå‡†

å¯¹å›ºå®šä¸€ä¸ªç‚¹ æ¯æ¬¡Random Walkçš„ç»“æœä¹‹é—´æ˜¯ç‹¬ç«‹çš„

é‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨`Chernoff bound(åˆ‡å°”è¯ºå¤«ç•Œé™)` ~~ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªå¤§æ•°å®šç†ä¸€æ ·çš„ä¸œè¥¿~~

* å¯¹ä»»æ„${x_i}\in[0,1](i\in[1,n_x])$, å‡å€¼ä¸º$\mu$çš„éšæœºå˜é‡, æœ‰$Pr\left\{|\sum\limits_{i=1}^{n_x}x_i-n_x\mu|\ge n_x\epsilon\right\}\le exp(-\dfrac{n_x\dot{}\epsilon^2}{2\epsilon/3+2\mu})$

å‡è®¾Random walkçš„æ¬¡æ•°$\ge O(\dfrac{\ln{n}}{\epsilon^2})$

é‚£ä¹ˆè¾¾åˆ°åœæ­¢æ¡ä»¶$|\tilde{\pi}(s,t)-\pi(s,t)|\le \epsilon$çš„æ¦‚ç‡è‡³å°‘$1-\dfrac{1}{n}$

åˆ™å¸¦å…¥`Chernoff bound`å¾—åˆ°$exp(-\dfrac{n_x\dot{}\epsilon^2}{2\epsilon/3+2\mu})< O(\dfrac{1}{n})=\delta$

åˆ™æ¨å‡º`Random walk`å®éªŒæ¬¡æ•°$n>-\dfrac{c}{\epsilon^2}\log{\delta}=O(\log{n})$

ç„¶åè¿™ä¸ªè¿‡ç¨‹ä¹Ÿç®—æ˜¯ä¸€ä¸ªPACè¿‡ç¨‹

> PAC =Probably Approximately Correct

è¾¾åˆ°0è¯¯å·®æ˜¯éå¸¸å›°éš¾ è€Œä¸”æ²¡æœ‰å¿…è¦çš„ æ‰€ä»¥éœ€è¦è¿½æ±‚è¯¯å·®æ¯”è¾ƒå°$\le \epsilon$ å¾—åˆ°è¿‘ä¼¼æ­£ç¡®çš„æ¦‚ç‡æ¯”è¾ƒå¤§$\ge 1-\delta$

## Forward Search
<p align="right">[FOCSâ€™06]</p>

æ¯ä¸ªnodeåŒ…å«

* Reserve: $\pi_f(s,v)$éšæœºæ¸¸èµ°åˆ°vï¼Œä¸”åœåœ¨v
* Residue: $r_f(s,v)$éšæœºå½“å‰æ¸¸èµ°åˆ°vï¼Œä¸åœ
  * åœ¨é€’å½’è¿‡ç¨‹ä¸­$r_f(s,v)$ä»£è¡¨ç€æœªåˆ†é…çš„æ¦‚ç‡å€¼

ä¸¾ä¸ªğŸŒ° ï¼Œå¦‚å›¾ æ¯ä¸ªèŠ‚ç‚¹è½¬ç§»å‡ºå»çš„æ¦‚ç‡ä¸º$1-\alpha$, ç•™åœ¨èŠ‚ç‚¹çš„æ¦‚ç‡ä¸º$\alpha$, åˆ™

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541483176417-5d7ca3f9-3d13-4f24-bdef-808ed347a811.png "")

* ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ²¡åˆ†é…çš„æ—¶å€™$\pi_f(s,s)=\alpha$, $r_f(s,s)=1-\alpha$
* å½“åˆ†é…åˆ°ç¬¬äºŒè½®çš„æ—¶å€™$\pi_f(s,s)=\alpha$, $r_f(s,s)=0$,  $r_f(s,v_i)=(1-\alpha)/3$

åˆ™æœ‰$\pi(s,t)=\pi_f(s,t)+\sum\limits_{v\in V}r_f(s,v)\dot{}\pi(v,t)$

å½“$r_f(s,t)$å¾ˆå°çš„æ—¶å€™ï¼Œè¿ç®—å°±æ²¡å¿…è¦å†è¿›è¡Œä¸‹å»äº†

å…¶æ—¶é—´å¤æ‚åº¦ä¸º$O(\dfrac{1}{r_{max}})$

## Backward Search
<p align="right">[WAWâ€™07]</p>

æœ‰Forward å¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯ä¸æ˜¯æœ‰`Backward`

æ­¤æ—¶çš„$\pi_b(v,t), r_b(v,t)$å°±å’ŒForwardçš„åŸºæœ¬ä¸€è‡´

- Reserve: $\pi_b(v,t)$ä»vå‡ºå‘ï¼Œè¿è¡Œåˆ°t, ä¸”åœåœ¨t
- Residue: $r_b(v,t)$ä»vå‡ºå‘, å½“å‰èµ°åˆ°tï¼Œä¸åœ

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541485485421-498f5f0b-f72c-4950-b907-424e2911438d.png "")

åŒæ ·å¯ä»¥æ¨å‡º$\pi(s,t)=\pi_b(s,t)+\sum\limits_{v\in V}r_b(v,t)\dot{}\pi(s,v)$

å½“ç„¶å¯ä»¥å§Forward Backwardç»“åˆåœ¨ä¸€èµ·é€šè¿‡å¹¶è¡ŒåŠ å¿«è®¡ç®—æ•ˆç‡

## FORA
<p align="right">[Wang et.al, KDDâ€™17]</p>

ç”±ä¸Šè¿°å¯çŸ¥
* Forward ç²¾ç¡®è§£ä»£ä»·å¤ªé«˜ å¯ä»¥è¾ƒæ—©çš„åœæ­¢ï¼Œä½†å°¾é¡¹ä¸èƒ½ä¿è¯è¿‘ä¼¼è§£
* MC å¯ä»¥ä¿è¯è¿‘ä¼¼è§£ ä½†æ•ˆç‡ä½ä¸‹

å°±æœ‰å­¦è€…æŠŠè¿™ä¸¤è€…ç»“åˆåœ¨ä¸€èµ·

åœ¨è®¡ç®—è¾ƒå¤§$\pi_f$æ—¶ä½¿ç”¨Forward å½“Forwardè¿›å…¥åœæ­¢è¿­ä»£å°¾é¡¹çš„æ—¶å€™ ä½¿ç”¨MCè¿›è¡Œè®¡ç®— ä»¥æé«˜ç²¾åº¦

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541486227755-b3e8283e-fcc9-4ee0-8048-58e891afce8c.png "")

MCé‚£ä¹ˆç²¾ç¡® é‚£ä¸ºå•¥ä¸ä¸€å¼€å§‹å°±ç”¨MCå‘¢

Forwardçš„costå¤§æ¦‚åœ¨MCçš„$1-\alpha$å€å·¦å³, ä¸¾ä¸ªæ —å­ è¿˜æ˜¯Forwardé‚£å¼ å›¾

* $Cost_f=(1-\alpha)w/\alpha+d_out$
* $Cost_M=w/\alpha$

è¿™åœ¨æ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹ å·®è·è¿˜æ˜¯æ¯”è¾ƒå¯è§‚çš„

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541486787842-80d2e97b-3653-4e6e-9367-b5a110496124.png "")

## Alias Method

ç°åœ¨æ’æ’­ä¸€ä¸ªå¤§å›¾ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªå¸¦æƒé‡‡æ ·ç®—æ³•

ä¸€å¼€å§‹çœ‹è§è¿™ä¸ªç®—æ³•åå­—çš„æ—¶å€™è§‰å¾—å¾ˆçœ¼ç†Ÿ

ç„¶åæˆ‘åŒå­¦æé†’æˆ‘`~/.zshrc`ä¸­æœ‰ ~~(å°´å°¬ä¸å¤±ç¤¼è²Œçš„å¾®ç¬‘)~~

ç›´è¯‘è¿‡æ¥å°±æ˜¯åˆ«åé‡‡æ ·ç®—æ³• ~~(åˆ«é—®æˆ‘é‡‡æ ·æ€ä¹ˆè¯‘å‡ºæ¥çš„)~~

> è€ƒè™‘ä¸€ä¸ªé—®é¢˜:ä¸€ä¸ªéšæœºäº‹ä»¶åŒ…å«å››ç§æƒ…å†µ, æ¯ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡åˆ†åˆ«ä¸º: $\dfrac{1}{2}$,$\dfrac{1}{3}$,$\dfrac{1}{12}$,$\dfrac{1}{12}$, é—®æ€ä¹ˆäº§ç”Ÿç¬¦åˆè¿™ä¸ªæ¦‚ç‡çš„é‡‡æ ·æ–¹æ³•

ä¸€ä¸ªå¾ˆç®€å•çš„æ€è·¯å°±æ˜¯äº§ç”Ÿä¸€ä¸ª$x\in[0,1]$çš„éšæœºæ•° ç„¶åæ ¹æ®xæ£€ç´¢åˆ°è¯¦æƒ…çš„å…·ä½“æƒ…å†µ, è¿™æ ·å°±è½¬å˜ä¸ºæœç´¢é—®é¢˜, ç”¨BSTå¯ä»¥è¾¾åˆ°$O(\log{n})$çš„å¤æ‚åº¦

ä½†æ˜¾ç„¶å¤æ‚åº¦ç¨å¾®é«˜äº†ç‚¹

### NaÃ¯ve Alias Method

æŠŠæ‰€æœ‰æƒ…å†µæ’æˆä¸€åˆ— æ·ä¸¤æ¬¡éª°å­ ç¬¬ä¸€æ¬¡å†³å®šåˆ— ç¬¬äºŒæ¬¡å†³å®šé‡‡æ ·æ˜¯å¦æˆåŠŸ

ä¾‹å¦‚å¦‚å›¾æƒ…å†µï¼Œå…ˆæ·ä¸€æ¬¡éª°å­, å…ˆç¡®å®šæ˜¯å››ç§æƒ…å†µä¸­çš„å“ªä¸€ç§ï¼Œå¦‚æœæ˜¯Aï¼Œåˆ™100%é‡‡æ ·A; å¦‚æœæ˜¯B, åˆ™$\dfrac{2}{3}$æ¦‚ç‡ä¸ºBï¼Œ$\dfrac{1}{3}$é‡è¯•

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541522557180-a99d841f-13a0-4499-8ca0-a946317e412f.png "")

å½“ç„¶è¿™æ ·åš ç­‰åŒäº æŠŠæŒ‰æœ€å¤§å€¼å½’ä¸€åŒ–å†è¿›è¡Œåˆ†æ

æˆ‘ä»¬æ¥è€ƒè™‘ä¸‹å¤æ‚åº¦, æœ€å¥½çš„æƒ…å†µï¼Œä¸€æ¬¡å°±ç»“æŸ$O(1)$ï¼Œä¸å¥½çš„æƒ…å†µä¸€ç›´ä¸€ç›´è¿­ä»£ä¸‹å»ï¼Œå¹³å‡å¤æ‚åº¦$O(n)$

### Alias Method

å›é¡¾åˆšæ‰çš„è¿‡ç¨‹ å¯ä»¥å‘ç° æˆ‘ä»¬åœ¨é‡è¯•çš„è¿‡ç¨‹ä¸­æ¶ˆè€—å¤ªå¤š æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å‡å°‘é‡è¯•æ¬¡æ•°å‘¢

åˆšæ‰æˆ‘ä»¬æŠŠæ‰€æœ‰æƒ…å†µéƒ½åˆ—æˆä¸€åˆ— é‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å…¶å’Œ=1

å¦‚æœæˆ‘ä»¬æŒ‰å‡å€¼è¿›è¡Œå½’ä¸€åŒ– æ˜¯ä¸æ˜¯æ‰€æœ‰æ–¹å—çš„å‡å€¼åº”è¯¥ä¸º1

çœ‹èµ·æ¥æ²¡ä»€ä¹ˆç”¨ å¦‚æœæˆ‘ä»¬åšä¸€äº›æ‹¼æ¥ å¾—åˆ°ä¸‹å›¾

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541523278932-47c5d594-50a6-4d75-8e4f-90631c7b3395.png "")

æ˜¯ä¸æ˜¯åªéœ€è¦æ·ä¸¤æ¬¡éª°å­å°±èƒ½ç¡®å®šåˆ°åº•æ˜¯å“ªä¸ªé‡‡æ ·

è¦æ³¨æ„è¿™ä¸ªæ‹¼æ¥æ˜¯æœ‰æ¡ä»¶çš„:
* æ»¡è¶³ä¸€å—ä¸­åªèƒ½`æœ€å¤šä¸¤ä¸ª`æ‹¼æ¥è€Œæˆ
* ç¬¬$i$å—å¿…é¡»åŒ…å«ç¬¬$i$å—çš„ä¸€éƒ¨åˆ†

å½“ç„¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªç–‘é—® åˆ°åº• æ˜¯ä¸æ˜¯éƒ½å­˜åœ¨è¿™ç§æ‹¼æ¥

äº‹å®ä¸Šå¯ä»¥è¯æ˜Alias æ‹¼æ¥çš„å­˜åœ¨æ€§ å…·ä½“å‚è€ƒ

ä¸ºä»€ä¹ˆçªç„¶æåˆ°ALiasé‡‡æ ·ç®—æ³•?

å›æƒ³ä¸€ä¸‹FORAç®—æ³• ç¬¬äºŒæ­¥MCç®—æ³•æ˜¯åœ¨ç¬¬ä¸€æ­¥è¾¾åˆ°åœæ­¢æ¡ä»¶ä¹‹åçš„éšæœºæ¸¸åŠ¨

åœ¨éšæœºæ¸¸èµ°æ¨¡æ‹Ÿçš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ¤åˆ«é‡‡æ ·çš„ç±»åˆ«

è€ƒè™‘ä¸‹`FORA`çš„æ—¶é—´å¤æ‚åº¦

MC: $O(\dfrac{n\ln{n}}{\epsilon^2})$

åˆ™Radom Walk: $O(r_{sum}\dfrac{n\ln{n}}{\epsilon^2})=O(mr_{max}\dfrac{n\ln{n}}{\epsilon^2})$, å…¶ä¸­$r_{sum}=\sum\limits_{v\in V}r(s,v)\le \sum\limits_{v\in V}d_{out}(v)r_{max}=mr_{max}$

åˆ™Total: $O(\dfrac{1}{r_{max}}+mr_{max}\dfrac{n\ln{n}}{\epsilon^2})$

ä»¤$r_{max}=\epsilon \sqrt{\dfrac{1}{nm\ln{n}}}$

åˆ™: $O(Total)=O(\dfrac{1}{\epsilon}\sqrt{mn\ln{n}})$

## Top-K single source PPR

äº‹å®ä¸Š åœ¨å¾ˆåœºæ™¯ä¸‹ æˆ‘ä»¬å¹¶ä¸å…³å¿ƒæ‰€æœ‰çš„PPRå€¼

å¤§éƒ¨åˆ†æ—¶å€™åªå¯¹Top-Kæ„Ÿå…´è¶£

å¦‚ä½•ç²¾å‡†çš„ä¼°è®¡å‰Kä¸ª æˆ–è€…è¯´ ç¬¬Kä¸ª PPRå€¼ æˆäº†å…³é”®é—®é¢˜

è§£å†³Top-Kçš„ä¸€ä¸ªç®€å•çš„æƒ³æ³•å°±æ˜¯åˆ©ç”¨è¿­ä»£

* ç»™å®šåˆå§‹å€¼$\delta = \dfrac{1}{k}$
* Run FORA
* Test solution
    * é€šè¿‡ä¸Šä¸‹é™æ¥è¯„ä¼°PPRå€¼
    * å¦‚æœæ²¡æ»¡è¶³ç²¾åº¦$\delta /= 2$, é‡å¤ç¬¬äºŒæ­¥
    * å¦‚æœæ»¡è¶³ç²¾åº¦åˆ™è¾“å‡º

### Multi-armed Bandit

ç„¶åå†æ’æ’­ä¸€ä¸ªé—®é¢˜ï¼Ÿ(è¿˜æ˜¯ç®—æ³•) ~~å‚»å‚»åˆ†ä¸æ¸…~~

> å‡å¦‚è¯´ä½ è¿›åˆ°ä¸€ä¸ªèµŒåœº æœ‰nå°è€è™æœºğŸ° çœ‹èµ·æ¥è¿™nå°è€è™æœºæ²¡å•¥åŒºåˆ«
> ä½†äº‹å®ä¸Š æ¯å°è€è™æœºéƒ½æœ‰è‡ªå·±çš„æ¦‚ç‡åˆ†å¸ƒ é‚£ä¹ˆå¦‚ä½•åˆ¶å®šç­–ç•¥å°è¯• ä»è€Œåœ¨æœ€å°çš„ä»£ä»·ä¸‹è·å¾—æœ€å¤§çš„åˆ©ç›Š

è¿™å°±æ˜¯`å¤šè‡‚è€è™æœºMAB`é—®é¢˜

å…¶å®è¿™æ˜¯ä¸€ä¸ªåœ¨Reinforcement learning, RLé¢†åŸŸå¾ˆç«çš„é—®é¢˜

ä¹Ÿæ‹¥æœ‰æå¼ºçš„åº”ç”¨åœºæ™¯

æ¨èç³»ç»Ÿ ä¸­ EE(Exploit-Explore)å’Œå†·å¯åŠ¨æ˜¯ä¸¤ä¸ªç»å…¸çš„é—®é¢˜

EEç›´è¯‘å°±æ˜¯åˆ©ç”¨ä¸æ¢ç´¢ï¼Œåˆ°åº•æ˜¯åº”è¯¥åˆ©ç”¨ç›®å‰ä¸ºæ•°ä¸å¤šçš„æ•°æ®è¿›è¡Œåˆ†æ è¿˜æ˜¯åº”è¯¥å†åšæ¢ç´¢æ‹¿åˆ°å¾ˆå¤šçš„ä¿¡æ¯

å†·å¯åŠ¨ï¼Œä¸»è¦é’ˆå¯¹çš„æ˜¯ç”¨æˆ·ç¬¬ä¸€æ¬¡è¿›å…¥ç³»ç»Ÿï¼Œåœ¨å¯¹ç”¨æˆ·ä¸€æ— æ‰€çŸ¥çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•æ›´æœ‰æ•ˆçš„è¿›è¡Œæ¨è

è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„ä¸€ä¸ªæœ‰æ•ˆé€”å¾„å°±æ˜¯MABç®—æ³•

#### A/B test

æœ€ç®€å•çš„ä¸€ç§æ€è·¯å°±æ˜¯æ¯å°è€è™æœºğŸ°å°è¯•næ¬¡ è®°å½•å›æŠ¥å€¼ å“ªå°è€è™æœºå¹³å‡å›æŠ¥æœ€å¤§ å°±é€‰å“ªå°

A/B testçš„æ ¸å¿ƒå°±æ˜¯`æ§åˆ¶å˜é‡`

1. æ¯å°è€è™æœºåœ¨ç›¸åŒæ¡ä»¶ä¸‹å°è¯•ç›¸åŒçš„æ¬¡æ•°n
2. ç„¶åæ ¹æ®è¿™$nÃ—m$çš„ç»“æœï¼Œå¯¹è€è™æœºæ”¶ç›Šè¿›è¡Œä¼°è®¡

ä½†å¾ˆæ˜¾ç„¶è¿™æ ·çš„ç®—æ³• è¦è¾¾åˆ°ä¸€å®šç²¾å‡†åº¦ éœ€è¦è¾ƒå¤§çš„ä»£ä»·

#### $\epsilon$-Greedy

è¿™ä¸ªç®—æ³•æœ‰ç‚¹åƒå‰é¢è¯´çš„NaÃ¯ve Alias Method, é€šè¿‡éšæœºç»“æœä¼°è®¡æ ·æœ¬æƒ…å†µ

1. æŒ‡å®šä¸€ä¸ª$\epsilon \in (0, 1)$
2. æ¯è½®ç»“æŸçš„æ—¶å€™ï¼Œä»¥æ¦‚ç‡$\epsilon$å†³å®šæ¢ç´¢, åœ¨æ‰€æœ‰è€è™æœºä¸­é€‰ä¸€ä¸ªä½œä¸ºä¸‹ä¸€ä¸ªå°è¯•é¡¹
3. ä»¥æ¦‚ç‡$1-\epsilon$ å†³å®šåˆ©ç”¨, é€‰æ‹©å½“å‰è·å–çš„æ ·æœ¬ä¸­æœ€å¥½çš„è€è™æœºä½œä¸ºä¸‹ä¸€ä¸ªå°è¯•é¡¹

è¿™æ˜¯ä¸€ä¸ªonlineè¿‡ç¨‹ï¼Œéšç€å°è¯•æ¬¡æ•°nçš„å¢å¤§ï¼Œæ‰€å¾—åˆ°çš„ç»“æœå°±è¶Šæ¥è¿‘çœŸå®å€¼

ä¸”éšç€$\epsilon$å€¼çš„å¢å¤§ï¼Œæ”¶æ•›é€Ÿåº¦è¶Šå¿« (è¶Šæ¿€è¿›è¶Šæœ‰å¯èƒ½å‘ç°çœŸç† æ‰€ä»¥åŒå­¦ä»¬ è¦ä¿æŒå¯¹ä¸–ç•Œçš„æ€€ç–‘)

ä½†$\epsilon$-Greedy å¿½ç•¥äº†å¯èƒ½å·²ç»å‡ºç°çš„ç‰¹å¾ ä»å§‹è‡³ç»ˆçš„è¿›è¡Œéšæœºç­›é€‰

å½“ç„¶ä¹Ÿæœ‰ä¸€äº›$\epsilon$-Greedy çš„å˜ç§ æ¯”å¦‚è¯´ä¸€å¼€å§‹å°è¯•æ¦‚ç‡é«˜ ä¹‹åæ¦‚ç‡æ…¢æ…¢å‡å°; é€šè¿‡é¢„ç­›é€‰ å…ˆæ¡†å®šå°èŒƒå›´ å†è¿›è¡Œ$\epsilon$-Greedy

#### SoftMax

å¤§è‡´æ€è·¯å°±æ˜¯ æ ¹æ®ç°æœ‰çš„ä¿¡æ¯è¿›è¡Œä¼°è®¡æœ€å¯èƒ½çš„æƒ…å†µ

1. æ ¹æ®ä¹‹å‰çš„æƒ…å†µè®¡ç®—æ¯ä¸€å°è€è™æœºçš„$p_k=\dfrac{e^{\dfrac{\widehat{\mu}_k}{k}}}{\sum e^{\dfrac{\widehat{\mu}_k}{k}}}$å€¼
2. é€‰æ‹©$p_kâ€‹$å€¼æœ€å¤§çš„ä½œä¸ºä¸‹ä¸€é˜¶æ®µé€‰æ‹©çš„è€è™æœº

å¥½åƒå’Œå‰é¢çš„æ²¡å•¥åŒºåˆ« éƒ½æ˜¯æ ¹æ®ç°æœ‰çš„ä¿¡æ¯ æ¥ä¼°è®¡åˆ†å¸ƒ

å®é™…ä¸Š SoftMaxçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡Tï¼ŒTemperatureæ¥æ§åˆ¶ä¼°è®¡çš„èŒƒå›´åŠ›åº¦

T-æ¸©åº¦ï¼Œç›´è§‚çš„æ„Ÿå—ï¼Œéšç€æ—¶é—´çš„å¢å¤§ï¼ŒTéšç€å‡å° é‚£ä¹ˆåœ¨åˆ†æ¯çš„Tå¯¼è‡´ç°æœ‰çš„æ ·æœ¬è¶Šé‡è¦

å¦å¤–SoftMaxä¹Ÿæœ‰ä¸€äº›å˜ä½“æ¯”å¦‚è¯´$p_k=(1-\gamma)\dfrac{w_k(t)}{\sum \limits_{j=1}^K w_j(t)}+\dfrac{\gamma}{K}$, å…¶ä¸­$w_j(t+1)=w_j(t)exp(\gamma \dfrac{r_j(t)}{p_j(t)K})$

#### UCB

è™½ç„¶`SoftMax`å·²ç»æœ‰ä¸€ç§å°è¯•è¶Šå¤š ä¼°è®¡è¶Šå¯ç”¨çš„æ„Ÿè§‰ ä½†ä»–æ²¡æœ‰è€ƒè™‘åˆ°ç½®ä¿¡åŒºé—´çš„é—®é¢˜ UCBåˆ™ä»ç½®ä¿¡åŒºé—´å‡ºå‘

> UCB = Upper Confidence Bound

1. å…ˆå¯¹æ¯ä¸€ä¸ªè€è™æœºéƒ½è¿›è¡Œä¸€æ¬¡æµ‹è¯•
2. è®¡ç®—$p_k=\bar{\mu}_k(t-1)+\sqrt{\dfrac{2\ln{t-1}}{T_{j,t-1}}}$, å…¶ä¸­$T_{j,t-1}$ä¸ºæˆªæ­¢åˆ°ç¬¬tè½®jè¿™å°è€è™æœºè¯•éªŒæ¬¡æ•°
3. é€‰æ‹©$p_k$å€¼æœ€å¤§çš„ä½œä¸ºä¸‹ä¸€é˜¶æ®µé€‰æ‹©çš„è€è™æœº

å’ŒSoftMaxç›¸æ¯” åªæ˜¯$p_k$è®¡ç®—æ–¹æ³•ç•¥æœ‰åŒºåˆ« ç„¶åè¿˜å¿…é¡»è¿›è¡Œä¸€æ¬¡é¢„æ“ä½œå¤„ç†

ä»”ç»†è§‚å¯Ÿ$p_k$å¼å­ï¼Œå…¶ä¸­åŒ…å«äº†è¯•éªŒæ¬¡æ•°

éšç€è¯•éªŒæ¬¡æ•°çš„å¢å¤§åé¢é‚£é¡¹å€¼è¶Šå°ï¼Œä»£è¡¨è¶Šæ¥è¿‘çœŸå®ï¼Œè€Œè¯•éªŒæ¬¡æ•°è¾ƒå°çš„æ—¶å€™ï¼Œå…¶å€¼è¾ƒå¤§ï¼Œä»è€Œä¸­å’Œä¸å¤ªå‡†çš„ç¬¬ä¸€é¡¹

æœ¬è´¨ä¸Š åä¸€é¡¹æ˜¯å‡å€¼çš„æ ‡å‡†å·®

é‚£ä¹ˆ ä¸ºä½•å«åšä¸Šç½®ä¿¡åŒºé—´ç®—æ³•å‘¢ï¼Ÿå…¶å®è¿™ä¸ªå¼å­æ˜¯ä»ç½®ä¿¡åŒºé—´æ¨å‡ºæ¥çš„

æ ¹æ®ä¸Šç½®ä¿¡åŒºé—´å…¬å¼å¯å¾—$P(\widehat{\mu}\ge\epsilon)\leexp(-n\epsilon^2/2)$, ä»¤å³ä¾§=$\delta$ $P(\widehat{\mu}\ge\sqrt{\dfrac{2}{n}\log(\dfrac{1}{\delta})})\le \delta$

åˆ™å…¶ å‡å€¼ä¼°è®¡å°±ä¸º$\widehat{\mu_i}(t-1)+\sqrt{\dfrac{2}{T_i(t-1)}\log{\dfrac{1}{\delta}}}â€‹$

å½“ç„¶ UCBè¿˜æœ‰å¾ˆå¤šæ”¹è¿›ç‰ˆ åœ¨è¿™å°±æå‡ºä¸€ä¸ªæœ€æœ´ç´ çš„æ€æƒ³

#### Thompson sampling

ä¹‹å‰UCBæ˜¯ä»ç½®ä¿¡åº¦çš„è§’åº¦å‡ºå‘è€ƒè™‘é—®é¢˜

è€Œ`Thompson sampling`åˆ™æ˜¯ç«™åœ¨è´å¶æ–¯çš„è§’åº¦ é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ç”¨å…ˆéªŒä¼°è®¡åéªŒ

1. å¯¹æ¯å°è€è™æœºç»´æŠ¤ä¸€ä¸ªtuple(winner, lose), é‡Œé¢å­˜æ”¾ç€å†å²æˆåŠŸã€å¤±è´¥æ•°ï¼Œå…¶ä¸­winnerï¼Œloseä¸ºbetaåˆ†å¸ƒçš„å‚æ•°
2. æ¯è½®ï¼Œæ¯å°è€è™æœºçš„betaåˆ†å¸ƒéšæœºäº§ç”Ÿä¸€ä¸ªå€¼$p_k$
3. é€‰æ‹©$p_k$å€¼æœ€å¤§çš„ä½œä¸ºä¸‹ä¸€é˜¶æ®µé€‰æ‹©çš„è€è™æœº

ç›¸å¯¹è€Œè¨€Thompson samplingçš„è®¡ç®—é‡ä¼šæ›´å°

å®é™…ä½¿ç”¨æ•ˆæœä¹Ÿå’ŒUCBä¸ç›¸ä¸Šä¸‹ åŸºæœ¬ä¸Šæ˜¯ç›®å‰ä½¿ç”¨æ¯”è¾ƒå¤šçš„ä¸€ä¸ªç®—æ³•

### Top-K arm indentification

åˆšæ‰æˆ‘ä»¬åˆ†æéƒ½æ˜¯é€‰æ‹©æ”¶ç›Šæœ€å¤§çš„è€è™æœº

å®é™…ä¸Šæˆ‘ä»¬çš„éœ€æ±‚ä¸ä¸€å®šæœ‰é‚£ä¹ˆå¼º å¯èƒ½åªéœ€è¦çŸ¥é“ä¸€ä¸ªTop-Kçš„é›†åˆå°±è¡Œäº†

æ¯”å¦‚è¯´æˆ‘ä»¬è¿™ä¸ªé—®é¢˜ åªéœ€è¦çŸ¥é“Top-Kçš„PPRå€¼

#### NaÃ¯ve Solution

é€‰æ‹©å®éªŒç»“æœçš„ç¬¬iå¤§è€è™æœº$\epsilon$èŒƒå›´å†…çš„è€è™æœº

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541573787235-6dfc26ce-5fc2-47cc-a89d-724824302f2d.png "")

#### MC solution

å¥½ æˆ‘ä»¬å›åˆ°å‰é¢è®²çš„`Top-K single source PPR`

æƒ³å¿… å¾ˆå¤šäºº å·²ç»å¿˜è®°æˆ‘ä»¬è¿™ç‰‡blogçš„ä¸»é¢˜äº† ~~(è¿æˆ‘è‡ªå·±ä¹Ÿè§‰å¾—æˆ‘å°±æ˜¯åœ¨è®²ğŸ°)~~

å¥½è·Ÿæˆ‘å¿µ `PPAP` `PPAP` `PPR` å¥½ å›åˆ°æˆ‘ä»¬çš„Top-K PPR

åˆ©ç”¨Chernoff boundä¼°è®¡æ‰€æœ‰ç‚¹çš„UB LBä¸”æ‰€æœ‰ç‚¹çš„$UB-LB$å‡ç›¸ç­‰

åˆ™å¸¦å…¥Top-K single source PPR æ ¹æ®åœæ­¢æ¡ä»¶ UB LBè¿›è¡ŒMCè¿­ä»£

ç„¶åæ ¹æ®å‰é¢è¯´çš„`banbit`ç®—æ³•ä¼°è®¡å‰kä¸ªPPR

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541575141776-d9ffe5e4-7eca-40db-8f58-1016c7f8edd1.png "")

## TopPPR algorithm
<p align="right">[Wei et.al., SIGMOD 18]</p>

MCçš„å®é™…ç²¾åº¦è¡¨ç°çš„æ¯”è¾ƒä½ï¼Œäºæ˜¯åˆå­¦è€…è€ƒè™‘æŠŠFORA å’ŒBackwardç»“åˆåœ¨ä¸€èµ·

åˆ©ç”¨Backward searchæ”¹å–„ç²¾åº¦ï¼Œå¾—åˆ°äº†TopPPR algorithm

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541575717225-029d8e44-0415-41ff-a04c-c50dc75406b5.png "")

$\pi(s,t)=\pi_f(s,t)+\sum\limits_{u\in V}r_f(s,u)\pi_b(u,t)+\sum\limits_{u,v\in V}r_f(s,u)\pi(u,v)r_b(v,t)$

ä½†é—®é¢˜æ˜¯Backwardå¿…é¡»çŸ¥é“ç›®æ ‡ç‚¹ å¯¹Top-Kè€Œè¨€ å°±æ˜¯éœ€è¦ç»™å‡ºä¸€ä¸ªå€™é€‰é›†

äºæ˜¯æˆ‘ä»¬å¤§è‡´æŠŠå€™é€‰é›†åˆ†ä¸ºä¸‰ä¸ªé›†åˆ `ä¸€å®šæ˜¯Top-Kçš„` `å¯èƒ½æ˜¯` `ä¸å¯èƒ½æ˜¯`

åå¤è¿­ä»£ é€šè¿‡`Empirical Bernstein`ä¸ç­‰å¼è®¡ç®—ç½®ä¿¡åŒºé—´

æ³¨æ„åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ æ¯ä¸ªç‚¹çš„é‡‡æ ·æ¬¡æ•°ä¸åŒ UB LBçš„å·®ä¹Ÿä¸åŒ

![å›¾ç‰‡.png | center | 556x500](https://cdn.nlark.com/yuque/0/2018/png/104214/1541576358980-827e356e-83c6-43f5-b6f2-d4acf36a3c8a.png "")

å›é¡¾ä¸‹åˆšæ‰çš„UB-LBç®—æ³• å¯ä»¥å‘ç°åœ¨ç¬¬kå¤§PPRé™„è¿‘çš„ç‚¹ å¾ˆå®¹æ˜“è¢«è¯¯é‡‡æ ·è¿›æ ·æœ¬ä¸­

å¥½ åˆ°è¿™é‡Œå¤§è‡´æŠŠPPRçš„å›¾æœç´¢ç®—æ³•è®²å®Œäº†

å¦å¤–è¿˜æœ‰ä¸€ä¸ªçŸ©é˜µè®¡ç®—åˆ†æ”¯ æœ€è¿‘å‡ å¹´ä¹Ÿå¾—åˆ°ä¸é”™çš„æˆæœ

è™½ç„¶ç›®å‰å·¥ä¸šç•Œä¸»æµé‡‡ç”¨å›¾æœç´¢ç®—æ³• (æ¯•ç«Ÿå¤æ‚åº¦$1-\alpha$å€)

## Reference

1. [The PageRank citation ranking: Bringing order to the web](http://ilpubs.stanford.edu:8090/422/1/1999-66.pdf)
2. [Towards scaling fully personalized pagerank: Algorithms, lower bounds, and experiments](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.98.3412&rep=rep1&type=pdf)
3. [Local graph partitioning using pagerank vectors](http://www.leonidzhukov.net/hse/2016/networks/papers/andersen06localgraph.pdf)
4. [Local computation of PageRank contributions](https://www.microsoft.com/en-us/research/uploads/prod/2016/11/Local-Computation-of-PageRank-Contributions.pdf)
5. [FORA: simple and effective approximate single-source personalized pagerank](http://www.weizhewei.com/papers/kdd17.pdf)
6. [Topppr: top-k personalized pagerank queries with precision guarantees on large graphs](http://www.weizhewei.com/papers/SIGMOD18.pdf)
7. [Chernoff bound](https://en.wikipedia.org/wiki/Chernoff_bound)
8. [Darts, Dice, and Coins: Sampling from a Discrete Distribution](http://www.keithschwarz.com/darts-dice-coins/)
9. [Vermorel, Joannes, and Mehryar Mohri. "Multi-armed bandit algorithms and empirical evaluation." European conference on machine learning. Springer, Berlin, Heidelberg, 2005.](https://cs.nyu.edu/~mohri/pub/bandit.pdf)
10. [The Upper Confidence Bound Algorithm](http://banditalgs.com/2016/09/18/the-upper-confidence-bound-algorithm/)

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"/>

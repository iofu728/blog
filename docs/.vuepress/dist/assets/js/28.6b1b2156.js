(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{461:function(s,t,a){"use strict";a.r(t);var n=a(2),r=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("p",[s._v("前面讲了"),a("router-link",{attrs:{to:"/other/pv.html"}},[s._v("如何利用脚本统计PV、UV")]),s._v("，"),a("router-link",{attrs:{to:"/other/mapreduce.html"}},[s._v("如何利用MapReduce对日志处理进行分布式操作")])],1),s._v(" "),a("p",[s._v("在继续探讨Hadoop全家桶之前，先把bash脚本做进一步优化")]),s._v(" "),a("p",[s._v("维护一个网站 真的很累")]),s._v(" "),a("p",[s._v("尤其是 一天都没几个访问量的时候")]),s._v(" "),a("p",[s._v("心塞塞 💔")]),s._v(" "),a("p",[s._v("每次登机子看日志 很麻烦")]),s._v(" "),a("p",[s._v("于是有了 写个脚本的冲动")]),s._v(" "),a("p",[s._v("但 后来 才发现 我看到的数据 大部分都是爬虫爬的")]),s._v(" "),a("p",[s._v("那个是气不打一处来 哎")]),s._v(" "),a("p",[s._v("PS: 其实 一一直在纠结用PV还是UV, 最后考虑到我们这个一次访问就会load所有页面的网站还是老老实实用UV吧")]),s._v(" "),a("p",[s._v("于是 对Nginx进行爬虫限制")]),s._v(" "),s._m(0),s._v(" "),a("p",[s._v("首先 Nginx中调优过对大部分脚本都能拦截 返回403")]),s._v(" "),a("p",[s._v("但")]),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),s._m(3),s._v(" "),s._m(4),a("p",[s._v("总结一下爬虫的日志可能有如下特征:")]),s._v(" "),s._m(5),s._v(" "),s._m(6),s._v(" "),s._m(7),s._v(" "),a("p",[s._v("总的来说，我们可以用<>来判断200是否是爬虫")]),s._v(" "),s._m(8),s._m(9),s._v(" "),a("p",[s._v("上述办法确实可以判断正常状态是否是爬虫，但对于一个非正常状态判断是否是爬虫却不太适用")]),s._v(" "),a("p",[s._v("因为上述规则不能涵盖所有爬虫状况")]),s._v(" "),a("p",[s._v("举个例子，没办法判断一个301的返回是不是正常的还是爬虫")]),s._v(" "),a("p",[s._v("仔细想来，只能建一个user Table")]),s._v(" "),a("p",[s._v("一个200之前的301一定会产生一个200")]),s._v(" "),a("p",[s._v("所以拿200做一张userlist")]),s._v(" "),a("p",[s._v("再联合查询")]),s._v(" "),a("p",[s._v("awk的联合查询相当于先把一个文件的数据放到一个map中，然后遍历第二个文件，利用这个map进行判断")]),s._v(" "),s._m(10),s._m(11),s._v(" "),a("p",[s._v("因为之前未做爬虫过滤导致user Table中混入了一些奇怪的爬虫")]),s._v(" "),a("p",[s._v("比如说")]),s._v(" "),s._m(12),a("p",[s._v("仔细观察会发现它的转入地址和请求地址都是各大网站，且一直在变，没有规律")]),s._v(" "),a("p",[s._v("这种想了想 只能利用建立黑名单来规避 也许不久以后会有好思路")]),s._v(" "),s._m(13),s._v(" "),a("p",[s._v("因为log里面多了好多404，甚至400的record")]),s._v(" "),a("p",[s._v("想了想还是做一下URI限制吧")]),s._v(" "),a("p",[s._v("其实我放出这些code相当于暴露了 我所有的目录结构")]),s._v(" "),a("p",[s._v("但是没事 这本来你们正常访问也看得见")]),s._v(" "),s._m(14),a("p",[s._v("然后结果就是基本上拦截了所有看上去奇奇怪怪的东西")]),s._v(" "),s._m(15)])},[function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"特征分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#特征分析","aria-hidden":"true"}},[this._v("#")]),this._v(" 特征分析")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ol",[t("li",[this._v("Nginx调优之前的爬虫都是能正确返回200，而且并没有拦截到所有爬虫")]),this._v(" "),t("li",[this._v("域名支持http及https协议，对于http的请求全部重定向到https，返回301代码")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("但对爬虫爬http的时候，返回的也是301 ..。此后不合理，需要更改")]),this._v(" "),t("li",[this._v("所以很明显403不能作为标志，但403肯定就是爬虫了")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ol",{attrs:{start:"3"}},[t("li",[this._v("那么301可以吗，答案很明显也是不能，很多正常请求重定向都会产生301")]),this._v(" "),t("li",[this._v("让我们来看一下状态码不是200日志都长啥样")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-vim extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[s._v("# load end of log\nawk "),a("span",{attrs:{class:"token string"}},[s._v("'{if($9!=200)print $0}'")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("access"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("log|tail "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token keyword"}},[s._v("n")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("2000")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v(">")]),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" log"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("test"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("log\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("vim")]),s._v(" log"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("test"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("log\n\n"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("47.52")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("239.131")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("03")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("19")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("01")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("52")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"POST /uuu.php HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("47.52")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("239.131")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("03")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("19")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("01")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("52")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET /web/phpMyAdmin/index.php HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0"')]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("104.192")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("74.15")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("03")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("20")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("47")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("20")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET /robots.txt HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.wyydsb.xin/robots.txt"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"')]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("77.88")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("5.4")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("04")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("05")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("29")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("34")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET /react/componentdidupdate.html HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; YandexBot/3.0; +http://yandex.com/bots)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("39.107")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("14.208")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("04")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("07")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("05")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("35")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET / HTTP/1.0"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("157.55")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("39.115")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("04")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("07")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("16")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("01")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET / HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("301")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("185")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("66.249")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("69.36")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("04")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Oct"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("10")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("25")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("39")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET /assets/js/35.48ffe973.js HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("404")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("169")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"https://wyydsb.xin/javaScript/structure.html"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; +http://www.google.com/bot.html) Safari/537.36"')]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),s._v("\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ol",[t("li",[this._v("带有php 额 不管php是不是天下第一语言，反正在目前这个版本的blog中，从来都没用过php")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("八成是之前WordPress留下的爬虫，再加上之前WordPress爆出有漏洞，可能有人借此广爬，所以最近有很多php的爬虫")]),this._v(" "),t("li",[this._v("顺带的POST请求也是不可能的")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ol",{attrs:{start:"2"}},[t("li",[this._v("带有robot, rot, spider的，robot.txt是一种对爬虫的规范性文件，另外在一些爬虫的Agent上会带有所属的爬虫名称，搜索引擎之类的，例如googlebot, bingbot, BaiduSpider etc.")]),this._v(" "),t("li",[this._v("语言类，python, go, java, curl")]),this._v(" "),t("li",[this._v('无Agent信息的，会带有"-" "-"特征')])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'{if("),a("span",{attrs:{class:"token variable"}},[s._v("$9")]),s._v("==200&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/bot/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/spider/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/php/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/taishan/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/POST/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Verification/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v('~/"-" "-"/&&'),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Python/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/go/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Go/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/python/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/curl/){print "),a("span",{attrs:{class:"token variable"}},[s._v("$1")]),s._v("}}'")]),s._v(" "),a("span",{attrs:{class:"token variable"}},[s._v("$loglocal")]),a("span",{attrs:{class:"token operator"}},[s._v("|")]),a("span",{attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("uniq")]),s._v(" -c "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),a("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" log/pv\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"awk的联合查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#awk的联合查询","aria-hidden":"true"}},[this._v("#")]),this._v(" AWK的联合查询")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("# create user map")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'{if("),a("span",{attrs:{class:"token variable"}},[s._v("$9")]),s._v("==200&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/bot/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/spider/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/php/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/taishan/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/POST/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Verification/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v('~/"-" "-"/&&'),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Python/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/go/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/Go/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/python/&&"),a("span",{attrs:{class:"token variable"}},[s._v("$0!")]),s._v("~/curl/){print "),a("span",{attrs:{class:"token variable"}},[s._v("$1")]),s._v("}}'")]),s._v(" "),a("span",{attrs:{class:"token variable"}},[s._v("$loglocal")]),a("span",{attrs:{class:"token operator"}},[s._v("|")]),a("span",{attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("uniq")]),s._v(" -c "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("sort")]),s._v(" -nr "),a("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" log/userpre\n"),a("span",{attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'{if("),a("span",{attrs:{class:"token variable"}},[s._v("$1")]),s._v(">5)print "),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" log/userpre "),a("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" log/user\n\n"),a("span",{attrs:{class:"token comment"}},[s._v("# union select")]),s._v("\n"),a("span",{attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'NR==FNR {a["),a("span",{attrs:{class:"token variable"}},[s._v("$2")]),s._v("]="),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("} NR!=FNR {if(FNR>1&&!("),a("span",{attrs:{class:"token variable"}},[s._v("$1")]),s._v(" in a)&&("),a("span",{attrs:{class:"token variable"}},[s._v("$9!")]),s._v("=200||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/bot/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/spider/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/php/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/taishan/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/POST/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/Verification/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v('~/"-" "-"/||'),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/Python/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/go/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/Go/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/python/||"),a("span",{attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/curl/))print "),a("span",{attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v(" log/user "),a("span",{attrs:{class:"token variable"}},[s._v("$loglocal")]),a("span",{attrs:{class:"token operator"}},[s._v("|")]),a("span",{attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("uniq")]),s._v(" -c "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),a("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" log/time\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"遗留"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#遗留","aria-hidden":"true"}},[this._v("#")]),this._v(" 遗留")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-vim extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("20")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("06")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("04")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://www.bjd.com.cn/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.bjd.com.cn/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("20")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("06")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("32")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://www.jumei.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.jumei.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("20")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("33")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("57")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://mail.sina.com.cn/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://mail.sina.com.cn/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("22")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("46")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://www.dangdang.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.dangdang.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("22")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("46")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("27")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://www.eastmoney.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.eastmoney.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("23")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("18")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("48")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://dl.pconline.com.cn/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://dl.pconline.com.cn/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("23")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("56")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("13")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://ie.sogou.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://ie.sogou.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("23")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("56")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://www.duomi.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://www.duomi.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("24")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("23")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("56")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://club.sohu.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://club.sohu.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("115.61")]),a("span",{attrs:{class:"token operator"}},[s._v(".")]),a("span",{attrs:{class:"token number"}},[s._v("84.234")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{attrs:{class:"token number"}},[s._v("25")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("Aug"),a("span",{attrs:{class:"token operator"}},[s._v("/")]),a("span",{attrs:{class:"token number"}},[s._v("2018")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("00")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("22")]),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{attrs:{class:"token number"}},[s._v("06")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("+")]),a("span",{attrs:{class:"token number"}},[s._v("0800")]),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"GET http://eos.changyou.com/ HTTP/1.1"')]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("5301")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"http://eos.changyou.com/"')]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)"')]),s._v("\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"限制请求uri"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限制请求uri","aria-hidden":"true"}},[this._v("#")]),this._v(" 限制请求URI")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-vim extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[s._v("        "),a("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$request_uri "),a("span",{attrs:{class:"token operator"}},[s._v("!~")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v('"^\\/(service-worker.js|robots.txt|assets.*|javaScript\\/[a-zA-Z0-9]{2,20}.html.*|other\\/[a-zA-Z0-9]{2,20}.html.*|pat\\/[a-zA-Z0-9]{2,20}.html.*|index.html|404.html|favicon.ico|)$"')]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("403")]),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2018/png/104214/1540616774453-678d0d7a-ecba-40e1-bfa2-c5512e1c7809.png",alt:"图片.png | center | 556x500"}})])}],!1,null,null,null);r.options.__file="spider.md";t.default=r.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{459:function(t,e,_){"use strict";_.r(e);var v=_(2),s=Object(v.a)({},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("div",{staticClass:"content"},[_("p",[t._v("初识这个命令的时候，还是山川dalao帮我在开发机上部署java程序时，打印日志的时候使用的")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),_("p",[t._v("后来自己在ECS上打印日志的时候也用到过这个命令，想还是深究一下这个问题")]),t._v(" "),t._m(2),t._v(" "),_("p",[t._v("其中")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),_("p",[t._v("上述命令其实可以分为两个部分，")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),_("p",[t._v("重定向符号中的数字有特殊的含义")]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),_("p",[t._v("其实多想一会就会发现这个看起来很骚的写法确实有它的好处")]),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),_("p",[t._v("很多时候看起来很漂亮的代码，可能也对应着性能上的提升")]),t._v(" "),t._m(22),t._v(" "),_("p",[t._v("经过上面的讲解 好像 明白了重定向 文件描述符的原理")]),t._v(" "),t._m(23),t._v(" "),_("p",[t._v("蛤 不是 说好 只有 0 1 2, 3又是啥子")]),t._v(" "),_("p",[t._v("其实 这里的 3 是一个我们自己定义的文件描述符")]),t._v(" "),_("p",[t._v("所以这句code的意识是")]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),_("p",[t._v("但实际上测试的时候发现运行的时候并不是这样的")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),_("p",[t._v("我是这么来理解的Linux执行命令的时候是从左至右")]),t._v(" "),t._m(29),t._v(" "),_("p",[t._v("遍历的原则是只考虑需要输出的fd，然后遍历到已知fd为止。")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),_("p",[t._v(". "),_("a",{attrs:{href:"https://mp.weixin.qq.com/s/k-QHnuIg7VnSTY9qyBZueQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux里的2>&1究竟是什么？"),_("OutboundLink")],1),_("br"),t._v("\n. "),_("a",{attrs:{href:"https://unix.stackexchange.com/questions/42728/what-does-31-12-23-do-in-a-script",target:"_blank",rel:"noopener noreferrer"}},[t._v("What does “3>&1 1>&2 2>&3” do in a script?"),_("OutboundLink")],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("当时觉得 这 2 呀 1 呀 & 什么的 怕不是位运算？"),e("br"),this._v("\n怎么就变成打印日志了")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("内心毫无波澜的仰慕")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("懒癌晚期的我就cope了一个例子"),e("code",[this._v("nohup command>/dev/null 2>&1 &")])])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[_("code",[t._v("nohup")]),t._v("代表 持久化 命令，使得在退出ssh之后，还能持续运行命令 = "),_("code",[t._v("no hang up")])]),t._v(" "),_("li",[t._v("最后一个"),_("code",[t._v("&")]),t._v(" 代表以job的方式不挂起运行")]),t._v(" "),_("li",[_("code",[t._v("/dev/null")]),t._v(" 代表空设备地址")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("所以等价于分析"),e("code",[this._v("command>/dev/null 2>&1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"重定向符"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重定向符","aria-hidden":"true"}},[this._v("#")]),this._v(" 重定向符"),e("code",[this._v(">")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这个命令想必大家多少都用过，"),e("br"),this._v("\n比如说两个二进制文件合成一个文件的时候")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("div",{staticClass:"language-bash extra-class"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[_("span",{attrs:{class:"token function"}},[t._v("cat")]),t._v(" a "),_("span",{attrs:{class:"token operator"}},[t._v(">>")]),t._v(" b\n"),_("span",{attrs:{class:"token comment"}},[t._v("# 其中 >  表示覆盖写入")]),t._v("\n"),_("span",{attrs:{class:"token comment"}},[t._v("#     >> 表示连续写入")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("先做了一个"),e("code",[this._v("cat a")]),this._v("命令")]),this._v(" "),e("li",[this._v("然后把"),e("code",[this._v("cat a")]),this._v("得到的输出，重定向到b中")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("看起来是显而易见的过程，组成了我们后面的"),e("code",[this._v("2>&1")]),this._v("命令")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_2-1-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-0","aria-hidden":"true"}},[this._v("#")]),this._v(" 2 1 0")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[t._v("0 表示"),_("code",[t._v("stdin")]),t._v("标准输入")]),t._v(" "),_("li",[t._v("1 表示"),_("code",[t._v("stdout")]),t._v("标准输出，系统默认值是1，所以"),_("code",[t._v(">b")]),t._v("等价于 "),_("code",[t._v("1>b")])]),t._v(" "),_("li",[t._v("2 表示"),_("code",[t._v("stderr")]),t._v("标准错误")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("那么"),e("code",[this._v("2>&1")]),this._v("的意识就应该是把命令的标准错误 重定向 到标准输出中")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("好像又不是 这里多了一个"),e("code",[this._v("&")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"and"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#and","aria-hidden":"true"}},[this._v("#")]),this._v(" "),e("code",[this._v(">")]),this._v(" and "),e("code",[this._v(">&")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("code",[this._v(">name")]),this._v("    表示将输出重定向到文件 name")]),this._v(" "),e("li",[e("code",[this._v(">&number")]),this._v(" 表示将输出重定向到文件描述符 number")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("所以这里"),e("code",[this._v("2>&1")]),this._v("的意识便是，把标准错误，重定向到文件描述符"),e("code",[this._v("&1")]),this._v("中，即把标准错误重定向到标准输出中")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("那看我们最初的那个例子"),e("br"),this._v(" "),e("code",[this._v("command>/dev/null 2>&1")]),this._v(" = "),e("code",[this._v("command 1>/dev/null 2>&1")])])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ol",[_("li",[t._v("把"),_("code",[t._v("command")]),t._v("的"),_("code",[t._v("标准输出")]),t._v("，重定向 至 "),_("code",[t._v("/dev/null")]),t._v("中")]),t._v(" "),_("li",[t._v("把"),_("code",[t._v("标准错误")]),t._v("重定向到标准输出，即 把 "),_("code",[t._v("标准错误")]),t._v(" 也 重定向 写入 "),_("code",[t._v("/dev/null")]),t._v("中")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这个时候 "),e("code",[this._v("重定向")]),this._v(" 就相当于 "),e("code",[this._v("指针")]),this._v("的概念"),e("br"),this._v(" "),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2018/png/104214/1538123222101-0129a050-0d43-4dc6-bbef-5f74e21dcb8e.png",alt:"图片.png | center | 556x200"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("我们为啥不写成"),e("code",[this._v("command>/dev/null 2>/dev/null")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("很明显，把重定向分成两个单独的操作之后，也意味着两次文件打开"),e("br"),this._v("\n这样的操作代价更大")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_3-1-1-2-2-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-2-2-3","aria-hidden":"true"}},[this._v("#")]),this._v(" "),e("code",[this._v("3>&1 1>&2 2>&3")]),this._v(" 💯")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("但 看到"),e("code",[this._v("3>&1 1>&2 2>&3")]),this._v("的时候 我还是一脸懵逼的")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("先定义个fd 叫做 3, 把它重定向 &1-stdout")]),this._v(" "),e("li",[this._v("把fd 1 重定向到 &2-stdeer")]),this._v(" "),e("li",[this._v("把fd 2 重定向到 &3")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("有人说，实际上做的是swap(stdout, stdeer)的工作"),e("br"),this._v("\n那么 我这个时候")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[t._v("执行"),_("code",[t._v("make 3>a 3>&1 1>&2 2>&3")]),t._v(" a中应该为"),_("code",[t._v("stdout")])]),t._v(" "),_("li",[t._v("执行"),_("code",[t._v("make 2>a 3>&1 1>&2 2>&3")]),t._v(" a中应该为"),_("code",[t._v("stdout")])]),t._v(" "),_("li",[t._v("执行"),_("code",[t._v("make 1>a 3>&1 1>&2 2>&3")]),t._v(" a中应该为"),_("code",[t._v("stdeer")])])])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[t._v("执行"),_("code",[t._v("make 3>a 3>&1 1>&2 2>&3")]),t._v(" a中为"),_("code",[t._v("stdeer")])]),t._v(" "),_("li",[t._v("执行"),_("code",[t._v("make 2>a 3>&1 1>&2 2>&3")]),t._v(" a中应该为"),_("code",[t._v("stdout + stdeer")])]),t._v(" "),_("li",[t._v("执行"),_("code",[t._v("make 1>a 3>&1 1>&2 2>&3")]),t._v(" a中应该为"),_("code",[t._v("stdout + stdeer")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2018/png/104214/1538127583777-edadb61f-f6e9-49ce-a657-cee8dbe7944e.png",alt:"图片.png | center | 556x200"}})])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[_("code",[t._v("make 3>a 3>&1 1>&2 2>&3")]),t._v(" "),_("ul",[_("li",[t._v("一开始遇到 fd 3的时候，不认识它，不输出。然后往右遍历，发现 3被2重定向，于是"),_("code",[t._v("fd3")]),t._v("="),_("code",[t._v("stdeer")]),t._v(", 输出;")])])]),t._v(" "),_("li",[_("code",[t._v("make 2>a 3>&1 1>&2 2>&3")]),t._v(" "),_("ul",[_("li",[t._v("一开始遇到 fd 2的时候，认识它，输出"),_("code",[t._v("stdeer")]),t._v("。然后往右遍历，发现 2被1重定向, 于是"),_("code",[t._v("fd2")]),t._v("="),_("code",[t._v("stdout")]),t._v(", 输出;")])])]),t._v(" "),_("li",[_("code",[t._v("make 1>a 3>&1 1>&2 2>&3")]),t._v(" "),_("ul",[_("li",[t._v("一开始遇到 fd 1的时候，认识它，输出"),_("code",[t._v("stdout")]),t._v("。然后往右遍历，发现 1被3重定向，3被2重定向, 于是"),_("code",[t._v("fd1")]),t._v("="),_("code",[t._v("stdeer")]),t._v(", 输出;")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("再回来看"),e("code",[this._v("make >a 2>&1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("一开始遇到 fd 1的时候，认识它，输出"),e("code",[this._v("stdout")]),this._v("。然后往右遍历，发现 1被2重定向，于是"),e("code",[this._v("fd1")]),this._v("="),e("code",[this._v("stdeer")]),this._v(", 输出;")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[this._v("#")]),this._v(" 参考")])}],!1,null,null,null);s.options.__file="redirect.md";e.default=s.exports}}]);
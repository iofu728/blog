<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dva | 乌云压顶是吧</title>
    <meta name="description" content="㊗️某人生日快乐🎉">
    
    
    <link rel="preload" href="/assets/css/0.styles.6acf8380.css" as="style"><link rel="preload" href="/assets/js/app.02cca196.js" as="script"><link rel="preload" href="/assets/js/7.0005dfa0.js" as="script"><link rel="prefetch" href="/assets/js/10.7ad27450.js"><link rel="prefetch" href="/assets/js/2.285762ea.js"><link rel="prefetch" href="/assets/js/3.ad3b6e7c.js"><link rel="prefetch" href="/assets/js/4.0f9f1586.js"><link rel="prefetch" href="/assets/js/5.5e526c6a.js"><link rel="prefetch" href="/assets/js/6.d8844d1c.js"><link rel="prefetch" href="/assets/js/8.62c9f7e5.js"><link rel="prefetch" href="/assets/js/9.e81b42cd.js"><link rel="prefetch" href="/assets/js/11.c37c162c.js"><link rel="prefetch" href="/assets/js/12.db5c7c0b.js"><link rel="prefetch" href="/assets/js/13.8b613be9.js"><link rel="prefetch" href="/assets/js/14.8fa9218f.js"><link rel="prefetch" href="/assets/js/15.a162fd7c.js"><link rel="prefetch" href="/assets/js/16.00f5c57b.js"><link rel="prefetch" href="/assets/js/17.90d4a479.js"><link rel="prefetch" href="/assets/js/18.af519db8.js"><link rel="prefetch" href="/assets/js/19.355ef318.js"><link rel="prefetch" href="/assets/js/20.171a4f1a.js"><link rel="prefetch" href="/assets/js/21.77afc3d0.js"><link rel="prefetch" href="/assets/js/22.e3dbb09b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6acf8380.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">乌云压顶是吧</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/react/componentdidupdate.html" class="nav-link">React</a></div><div class="nav-item"><a href="/summary/cs.html" class="nav-link">Summary</a></div><div class="nav-item"><a href="/pdd/" class="nav-link router-link-active">Pdd</a></div> <a href="https://github.com/iofu728/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/react/componentdidupdate.html" class="nav-link">React</a></div><div class="nav-item"><a href="/summary/cs.html" class="nav-link">Summary</a></div><div class="nav-item"><a href="/pdd/" class="nav-link router-link-active">Pdd</a></div> <a href="https://github.com/iofu728/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/pdd/" class="sidebar-link">介绍</a></li><li><a href="/pdd/structure.html" class="sidebar-link">目录约定</a></li><li><a href="/pdd/router.html" class="sidebar-link">路由</a></li><li><a href="/pdd/dva.html" class="active sidebar-link">Dva</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pdd/dva.html#什么是-dva" class="sidebar-link">什么是 Dva</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#models" class="sidebar-link">Models</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#取数据-mapstatetoprops" class="sidebar-link">取数据 mapStateToProps</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#router" class="sidebar-link">Router</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#数据流向" class="sidebar-link">数据流向</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#与umi结合使用" class="sidebar-link">与umi结合使用</a></li><li class="sidebar-sub-header"><a href="/pdd/dva.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/pdd/promise.html" class="sidebar-link">函数式编程</a></li><li><a href="/pdd/fetch.html" class="sidebar-link">Fetch</a></li><li><a href="/pdd/deploy.html" class="sidebar-link">部署</a></li><li><a href="/pdd/style.html" class="sidebar-link">Style</a></li><li><a href="/pdd/mock.html" class="sidebar-link">Mock 数据</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>参考</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/pdd/faq.html" class="sidebar-link">FAQ</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="dva"><a href="#dva" aria-hidden="true" class="header-anchor">#</a> Dva</h1> <h2 id="什么是-dva"><a href="#什么是-dva" aria-hidden="true" class="header-anchor">#</a> 什么是 Dva</h2> <p>首先 Dva 是 React 框架 下 一种数据<code>维护</code>/<code>处理</code>/<code>流</code> 方案</p> <h3 id="一-react-表示法"><a href="#一-react-表示法" aria-hidden="true" class="header-anchor">#</a> 一: React 表示法</h3> <p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436560812-2586a0b5-7a6a-4a07-895c-f822fa85d5de.png" alt="图片.png | left | 747x518"></p> <p>参照 React 官方文档, 如果多个 Component 之间要发生交互, 那么状态(即: 数据)就保存在在这些 Component 的最小公约父节点上, 即 <code>&lt;App/&gt;</code></p> <p><code>&lt;TodoList/&gt; &lt;Todo/&gt;</code> 以及<code>&lt;AddTodoBtn/&gt;</code> 本身不维持任何 state, 完全由父节点<code>&lt;App/&gt;</code> 传入 props 以决定其展现, 是一个纯函数的存在形式, 即: <code>Pure Component</code></p> <h3 id="二-redux-表示法"><a href="#二-redux-表示法" aria-hidden="true" class="header-anchor">#</a> 二: Redux 表示法</h3> <p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436134375-4c15f63d-72f1-4c73-94a6-55b220d2547c.png" alt="图片.png | left | 747x558"></p> <p>Redux 做了以下改进：</p> <ol><li>将数据状态及页面逻辑从 <code>&lt;App/&gt;</code>里面抽取出来, 变成 store-数据, reducer-页面逻辑</li> <li><code>&lt;TodoList/&gt;</code> 及<code>&lt;AddTodoBtn/&gt;</code>都是 Pure Component, 通过 connect 方法可以很方便地给它俩加一层 wrapper 从而建立起与 store 的联系: 可以通过 dispatch 向 store 注入 action, 促使 store 的状态进行变化, 同时又订阅了 store 的状态变化, 一旦状态有变, 被 connect 的组件也随之刷新</li> <li>使用 dispatch 往 store 发送 action 的这个过程是可以被拦截的, 自然而然地就可以在这里增加各种 Middleware, 实现各种自定义功能, eg: logging</li></ol> <p>这样一来, 各个部分各司其职, 耦合度更低, 复用度更高, 扩展性更好</p> <h3 id="三-加入-saga"><a href="#三-加入-saga" aria-hidden="true" class="header-anchor">#</a> 三: 加入 Saga</h3> <p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436167824-7fa834ea-aa6c-4f9f-bab5-b8c5312bcf7e.png" alt="图片.png | left | 747x504"></p> <p><code>redux-saga</code> 是一种 通过拦截action，实现异步操作的Middleware</p> <ol><li>saga 拦截某个 异步action A, 将action改为 A_REQUEST，并发起 http 请求；</li> <li>如果请求成功, 则继续向 reducer 发一个 type == A_SUCCESS 的 action, 提示创建成功, 反之则发送 type == A_FAILURE 的 action</li> <li>saga 针对异步 请求 自身特点 给出了 一些 异步处理的API， 如<code>take</code>， <code>call</code>， <code>put</code>，<code>all</code>；还有一些高阶API， 如<code>takeLeast</code>， <code>takeLeading</code>，<code>throttle</code>。这些API 对于处理异步数据流 是十分方便的。</li></ol> <h3 id="四-dva-表示法"><a href="#四-dva-表示法" aria-hidden="true" class="header-anchor">#</a> 四: Dva 表示法</h3> <p><img src="https://cdn.yuque.com/yuque/0/2018/png/103904/1528436195004-cd3800f2-f13d-40ba-bb1f-4efba99cfe0d.png" alt="图片.png | left | 747x490"></p> <p>Dva 就做了一件事： 把redux 和 redux-saga 封装在一起， 简化了原本较为繁冗的代码</p> <ol><li>把 store 及 saga 统一为一个 model 的概念, 写在一个 js 文件里面</li> <li>增加了一个 Subscriptions, 用于收集其他来源的 action, eg: 键盘操作，进入页面（可代替react的 <code>componentDidMount</code>）</li> <li>model 写法很简约</li></ol> <h2 id="models"><a href="#models" aria-hidden="true" class="header-anchor">#</a> Models</h2> <h3 id="state"><a href="#state" aria-hidden="true" class="header-anchor">#</a> State</h3> <p><code>type State = any</code></p> <p>State 表示 存在<code>Store</code>中的数据，通常表现为一个 <code>javascript</code> 对象；️️操作的时候每次都要当作不可变数据（immutable data）来对待，特别是js中的原生Map，保证每次都是全新对象，没有引用关系，这样才能保证 State 的独立性，便于测试和追踪变化。</p> <p>可通过 dva 的实例属性 <code>_store</code> 看到顶部的 state 数据，但是通常你很少会用到:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>_store<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 顶部的 state 数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="action"><a href="#action" aria-hidden="true" class="header-anchor">#</a> Action</h3> <p><code>type Action = any</code></p> <p>Action 是一个普通 <code>javascript</code> 对象，它是改变 <code>State</code> 的唯一途径。无论是从 UI 事件、网络回调，还是 WebSocket 等数据源所获得的数据，最终都会通过 dispatch/put 函数调用一个 action，从而改变对应的数据。</p> <p>action 必须带有 <code>type</code> 属性指明具体的行为，其它字段可以自定义，如果要发起一个 action 需要使用 <code>dispatch</code> 函数；需要注意的是 <code>dispatch</code> 是在组件 connect Models以后，通过 props 传入的。</p> <p>在Dva中，action可以作用于 <code>effect</code> 和 <code>reducer</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dispatch({
  type: 'fetchTaskList',
  filter: {
    offset: 0,
    limit: 20,
  }
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="dispatch-函数"><a href="#dispatch-函数" aria-hidden="true" class="header-anchor">#</a> dispatch 函数</h3> <p><code>type dispatch = (a: Action) =&gt; Action</code></p> <p>dispatch function 是一个用于触发 action 的函数，action 是改变 State 的唯一途径，但是它只描述了一个行为，而 dipatch 可以看作是触发这个行为的方式，而 Reducer 则是描述如何改变数据的。</p> <p>在 dva 中，connect Model 的组件通过 props 可以访问到 dispatch，可以调用 Model 中的 Reducer 或者 Effects，常见的形式如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">'user/add'</span><span class="token punctuation">,</span> <span class="token comment">// 如果在 model 外调用，需要添加 namespace</span>
  xxx<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 需要传递的信息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="reducer"><a href="#reducer" aria-hidden="true" class="header-anchor">#</a> Reducer</h3> <p><code>type Reducer&lt;S, A&gt; = (state: S, action: A) =&gt; S</code></p> <p>Reducer（也称为 reducing function）函数接受两个参数：之前已经累积运算的结果和当前要被累积的值，返回的是一个新的累积结果。该函数把一个集合归并成一个单值。</p> <p>Reducer 的概念来自于是函数式编程，很多语言中都有 reduce API。如在 javascript 中：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//expect return 6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在 dva 中，reducers 做的就是 拿到新旧数据，并返回将要更新的结果。</p> <p>一般，reducer只用来做数据更新的工作，不做任何其他作用。（数据比较这些都放在effec中进行，reducer不放任何和业务逻辑有关的东西，相当于redux中同步调用）</p> <h3 id="effect🎈"><a href="#effect🎈" aria-hidden="true" class="header-anchor">#</a> <strong>Effect</strong>🎈</h3> <h4 id="很重要的函数"><a href="#很重要的函数" aria-hidden="true" class="header-anchor">#</a> 很重要的函数</h4> <p>Effect 可以被翻译成副作用，最常见的用处就是实现异步操作。它来自于函数编程的概念，之所以叫副作用是因为它使得我们的函数变得不纯，同样的输入不一定获得同样的输出。</p> <p>dva 为了控制副作用的操作，底层引入了<a href="http://superraytin.github.io/redux-saga-in-chinese" target="_blank" rel="noopener noreferrer">redux-sagas<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>做异步流程控制。采用了<a href="http://www.ruanyifeng.com/blog/2015/04/generator.html" target="_blank" rel="noopener noreferrer">generator的相关概念<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，所以将异步转成同步写法，从而将effects转为纯函数。通过yield实现异步等待，从而完成异步的功能。</p> <p>在我看来， reducer是一个重要的部分，有关数据的业务逻辑一般放在这里，使得数据在进入DOM之后不会有过多的处理工作，尽量把React写成<code>Pure PureComponent</code>。</p> <p>像Taishan中数据处理最复杂的Task模块，所有处理工作都放在<code>/models/task.js</code>的effect中，复杂的函数长达数百行。</p> <h4 id="saga-低阶api"><a href="#saga-低阶api" aria-hidden="true" class="header-anchor">#</a> saga 低阶Api</h4> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token operator">*</span> <span class="token function">fetchTaskDetail</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> taskId <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call<span class="token punctuation">,</span> put<span class="token punctuation">,</span> select<span class="token punctuation">,</span> all <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> layout<span class="token punctuation">:</span> <span class="token punctuation">{</span> intervals <span class="token punctuation">}</span><span class="token punctuation">,</span> task<span class="token punctuation">:</span> <span class="token punctuation">{</span> report<span class="token punctuation">:</span> <span class="token punctuation">{</span> taskDetail<span class="token punctuation">:</span> taskDetailAgo<span class="token punctuation">,</span> taskInfo <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">select</span><span class="token punctuation">(</span>state <span class="token operator">=&gt;</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>intervals<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> taskDetail <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>taskServices<span class="token punctuation">.</span>fetchTaskDetail<span class="token punctuation">,</span> taskId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>taskDetail<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">compareObject</span><span class="token punctuation">(</span>taskDetail<span class="token punctuation">)</span><span class="token punctuation">(</span>taskDetailAgo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'saveTaskDetail'</span><span class="token punctuation">,</span> taskDetail <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>taskInfo<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'prepareTaskReport'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>当action 中的 type 匹配到'fetchTaskDetail', 则会调用上述Generate *函数。</p> <p>该函数有两个参数，第一个参数是dispatch传进来的Object，在这里你可以获取需要的参数值；第二个参数是redux-saga Api名称，仅支持低阶APi（高阶利用另外方法掉用）。</p> <p>可以看到该函数用到了四个saga的<code>APi</code>，<code>call``put``select``all</code><br>
分别实现</p> <p><code>select</code>-从store获取state值,<br> <code>call</code>  -调用services里面的request，并传入参数，<br> <code>put</code>   -相当于model外的dispatch，发送action请求，在这里主要用于调用下游函数/存储函数reducer<br> <code>all</code>   -使得all数组中的请求 同步进行 减小异步等待 造成的时间损耗，<br>
还可能使用<br> <code>take</code>  -等待函数，用于实现进度同步,</p> <p>该函数做了以下几件事：</p> <ol><li>select出intervals，如果intervals为false，函数终止，顺便select出store中存储的旧的数据；</li> <li>调用services请求，并堵塞直到收到Http Response；</li> <li>如果超时 或者 报错，则拿到的result为空，此时，不存入store，函数终止；</li> <li>比较拿到的result值，如果更新了就调用reducer；</li> <li>如果taskInfo不为空则，运行prepare函数，prepare函数是位于effect中的数据处理函数；</li></ol> <h4 id="saga-高阶api"><a href="#saga-高阶api" aria-hidden="true" class="header-anchor">#</a> Saga 高阶Api</h4> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>    fetchTaskFlowDetail<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">fetchTaskFlowDetailFunc</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> taskFlowId <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call<span class="token punctuation">,</span> put<span class="token punctuation">,</span> select<span class="token punctuation">,</span> all <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> task<span class="token punctuation">:</span> <span class="token punctuation">{</span> taskFlow<span class="token punctuation">:</span> <span class="token punctuation">{</span> taskFlowDetail<span class="token punctuation">:</span> taskFlowDetailAgo<span class="token punctuation">,</span> taskFlowAllReport <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> layout<span class="token punctuation">:</span> <span class="token punctuation">{</span> intervals <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">select</span><span class="token punctuation">(</span>state <span class="token operator">=&gt;</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>intervals <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>taskFlowDetailAgo<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> taskFlowDetail <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>taskServices<span class="token punctuation">.</span>fetchTaskFlowDetail<span class="token punctuation">,</span> taskFlowId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>taskFlowDetail<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> taskFlowDetail<span class="token punctuation">;</span>
        taskFlowDetail<span class="token punctuation">.</span>completed <span class="token operator">=</span> status <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token string">'200700'</span> <span class="token operator">||</span> status <span class="token operator">===</span> <span class="token string">'200800'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">compareObject</span><span class="token punctuation">(</span>taskFlowDetail<span class="token punctuation">)</span><span class="token punctuation">(</span>taskFlowDetailAgo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'saveTaskFlowDetail'</span><span class="token punctuation">,</span> taskFlowDetail <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">yield</span> <span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'prepareTaskFlowDetail'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>taskFlowDetail<span class="token punctuation">.</span>completed <span class="token operator">&amp;&amp;</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'prepareTaskFlowRealMetric'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">yield</span> <span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          <span class="token function">Boolean</span><span class="token punctuation">(</span>taskFlowDetail<span class="token punctuation">.</span>completed <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>taskFlowAllReport<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>allReport<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'fetchTaskFlowAllReport'</span><span class="token punctuation">,</span> taskFlowId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>taskFlowDetailAgo<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'prepareTaskFlowList'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'takeLatest'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>和上面的effect 略有不同，当使用高阶APi时候，是在数组的第二项中调用。然后把原来的函数放在数组的第一项。<br>
目前dva 资瓷 <code>takeEvery</code>,<code>takeLeast</code>,<code>throttle</code> 详见-&gt;<a href="https://github.com/dvajs/dva/blob/master/packages/dva-core/src/getSaga.js" target="_blank" rel="noopener noreferrer">dva源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>其实 特别 期待 支持 <code>takeLeading</code>的 虽然 可以通过低阶Api 组合使用 但 目前 测试take 未起作用。// todo</p> <h3 id="subscription"><a href="#subscription" aria-hidden="true" class="header-anchor">#</a> Subscription</h3> <p>Subscriptions 是一种从 <strong>源</strong> 获取数据的方法，它来自于 elm。</p> <p>Subscription 语义是订阅，用于订阅一个外部事件，然后根据条件 dispatch 需要的 action。外部可以是当前的时间、服务器的 websocket 连接、keyboard 输入、history 路由变化等等。</p> <p>目前TAISHAN项目中 主要利用其 代替React的<code>componentDidMount</code>，监听路由变化，从而开始/结束调用异步请求。</p> <p>此外还利用进行些许键盘快捷键定制。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>  subscriptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> history <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> history<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> pathname <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        nowPath <span class="token operator">=</span> pathname <span class="token operator">===</span> <span class="token string">'/'</span> <span class="token operator">?</span> <span class="token string">'/task'</span> <span class="token punctuation">:</span> pathname<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>baseUrl<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'com'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>importScriptTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'fetchHashList'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'application/javascript'</span><span class="token punctuation">;</span>
          script<span class="token punctuation">.</span><span class="token keyword">async</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://cavalry.corp.yiran.com/sdk/js/v1.js'</span><span class="token punctuation">;</span>
          document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeInterval<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'fetchUser'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'fetchTime'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'group/fetchGroupList'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'flow/fetchDefaultScript'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        timeInterval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'fetchTime'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> intervalTime <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'timeAdd'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> intervalTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="取数据-mapstatetoprops"><a href="#取数据-mapstatetoprops" aria-hidden="true" class="header-anchor">#</a> 取数据 mapStateToProps</h2> <p>和redux一致 利用connect把数据和component绑定在一起</p> <p>利用mapStateToProps, 把redux state中的数据放到props中</p> <p>此后 每次该component绑定的数据发生变更，该方法将会被再次调用</p> <p>随之 一系列生命周期 会被依次调用</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">mapStateToProps</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token punctuation">{</span> effects <span class="token punctuation">}</span><span class="token punctuation">,</span> layout<span class="token punctuation">:</span> <span class="token punctuation">{</span> isAdmin<span class="token punctuation">,</span> user<span class="token punctuation">:</span> <span class="token punctuation">{</span> userList<span class="token punctuation">,</span> grantList <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> routing<span class="token punctuation">:</span> <span class="token punctuation">{</span> location<span class="token punctuation">:</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">;</span>
  <span class="token keyword">const</span> path <span class="token operator">=</span> pathname<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    isAdmin<span class="token punctuation">,</span> userList<span class="token punctuation">,</span> grantList<span class="token punctuation">,</span>
    grantLoad<span class="token punctuation">:</span> effects<span class="token punctuation">[</span><span class="token string">'layout/fetchGrantList'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    groupId<span class="token punctuation">:</span> path<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="router"><a href="#router" aria-hidden="true" class="header-anchor">#</a> Router</h2> <p>该部分由umi自动生成</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Router<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva/router'</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>history<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Router</span> <span class="token attr-name">history</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>history<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Route</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>HomePage<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Router</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="数据流向"><a href="#数据流向" aria-hidden="true" class="header-anchor">#</a> 数据流向</h2> <p>数据的改变发生通常是通过用户交互行为或者浏览器行为（如路由跳转等）触发的，当此类行为会改变数据的时候可以通过 <code>dispatch</code> 发起一个 action，如果是同步行为会直接通过 <code>Reducers</code> 改变 <code>State</code> ，如果是异步行为（副作用）会先触发 <code>Effects</code> 然后流向 <code>Reducers</code> 最终改变 <code>State</code>，所以在 dva 中，数据流向非常清晰简明，并且思路基本跟开源社区保持一致（也是来自于开源社区）。</p> <img src="https://zos.alipayobjects.com/rmsportal/PPrerEAKbIoDZYr.png" width="807"> <h2 id="与umi结合使用"><a href="#与umi结合使用" aria-hidden="true" class="header-anchor">#</a> 与umi结合使用</h2> <ul><li><strong>按目录约定注册 model</strong>，无需手动 <code>app.model</code></li> <li><strong>文件名即 namespace</strong>，可以省去 model 导出的 <code>namespace</code> key</li> <li><strong>无需手写 router.js</strong>，交给 umi 处理，支持 model 和 component 的按需加载</li> <li><strong>内置 query-string 处理</strong>，无需再手动解码和编码</li> <li><strong>内置 dva-loading 和 dva-immer</strong>，其中 dva-immer 需通过配置开启</li> <li><strong>开箱即用</strong>，无需安装额外依赖，比如 dva、dva-loading、dva-immer、path-to-regexp、object-assign、react、react-dom 等</li></ul> <h2 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://github.com/sorrycc/blog/issues/66" target="_blank" rel="noopener noreferrer">使用 umi 改进 dva 项目开发<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/sorrycc/blog/issues/62" target="_blank" rel="noopener noreferrer">umi + dva，完成用户管理的 CURD 应用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://dvajs.com/guide/concepts.html" target="_blank" rel="noopener noreferrer">dva文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/25/2018, 11:24:32 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pdd/router.html" class="prev">
          路由
        </a></span> <span class="next"><a href="/pdd/promise.html">
          函数式编程
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/7.0005dfa0.js" defer></script><script src="/assets/js/app.02cca196.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>函数式编程 | 乌云压顶是吧</title>
    <meta name="description" content="㊗️某人生日快乐🎉">
    
    
    <link rel="preload" href="/assets/css/0.styles.6acf8380.css" as="style"><link rel="preload" href="/assets/js/app.02cca196.js" as="script"><link rel="preload" href="/assets/js/11.c37c162c.js" as="script"><link rel="prefetch" href="/assets/js/10.7ad27450.js"><link rel="prefetch" href="/assets/js/2.285762ea.js"><link rel="prefetch" href="/assets/js/3.ad3b6e7c.js"><link rel="prefetch" href="/assets/js/4.0f9f1586.js"><link rel="prefetch" href="/assets/js/5.5e526c6a.js"><link rel="prefetch" href="/assets/js/6.d8844d1c.js"><link rel="prefetch" href="/assets/js/7.0005dfa0.js"><link rel="prefetch" href="/assets/js/8.62c9f7e5.js"><link rel="prefetch" href="/assets/js/9.e81b42cd.js"><link rel="prefetch" href="/assets/js/12.db5c7c0b.js"><link rel="prefetch" href="/assets/js/13.8b613be9.js"><link rel="prefetch" href="/assets/js/14.8fa9218f.js"><link rel="prefetch" href="/assets/js/15.a162fd7c.js"><link rel="prefetch" href="/assets/js/16.00f5c57b.js"><link rel="prefetch" href="/assets/js/17.90d4a479.js"><link rel="prefetch" href="/assets/js/18.af519db8.js"><link rel="prefetch" href="/assets/js/19.355ef318.js"><link rel="prefetch" href="/assets/js/20.171a4f1a.js"><link rel="prefetch" href="/assets/js/21.77afc3d0.js"><link rel="prefetch" href="/assets/js/22.e3dbb09b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6acf8380.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">乌云压顶是吧</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/react/componentdidupdate.html" class="nav-link">React</a></div><div class="nav-item"><a href="/summary/cs.html" class="nav-link">Summary</a></div><div class="nav-item"><a href="/pdd/" class="nav-link router-link-active">Pdd</a></div> <a href="https://github.com/iofu728/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/react/componentdidupdate.html" class="nav-link">React</a></div><div class="nav-item"><a href="/summary/cs.html" class="nav-link">Summary</a></div><div class="nav-item"><a href="/pdd/" class="nav-link router-link-active">Pdd</a></div> <a href="https://github.com/iofu728/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/pdd/" class="sidebar-link">介绍</a></li><li><a href="/pdd/structure.html" class="sidebar-link">目录约定</a></li><li><a href="/pdd/router.html" class="sidebar-link">路由</a></li><li><a href="/pdd/dva.html" class="sidebar-link">Dva</a></li><li><a href="/pdd/promise.html" class="active sidebar-link">函数式编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pdd/promise.html#lambda-radma" class="sidebar-link">lambda - radma</a></li><li class="sidebar-sub-header"><a href="/pdd/promise.html#curry" class="sidebar-link">curry</a></li><li class="sidebar-sub-header"><a href="/pdd/promise.html#promise" class="sidebar-link">promise</a></li><li class="sidebar-sub-header"><a href="/pdd/promise.html#箭头函数" class="sidebar-link">箭头函数</a></li><li class="sidebar-sub-header"><a href="/pdd/promise.html#组件设计" class="sidebar-link">组件设计</a></li><li class="sidebar-sub-header"><a href="/pdd/promise.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/pdd/fetch.html" class="sidebar-link">Fetch</a></li><li><a href="/pdd/deploy.html" class="sidebar-link">部署</a></li><li><a href="/pdd/style.html" class="sidebar-link">Style</a></li><li><a href="/pdd/mock.html" class="sidebar-link">Mock 数据</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>参考</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/pdd/faq.html" class="sidebar-link">FAQ</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="函数式编程"><a href="#函数式编程" aria-hidden="true" class="header-anchor">#</a> 函数式编程</h1> <p>关于什么是函数式编程 每个人都有自己的看法</p> <p>但总结起来 不外乎几点</p> <ol><li>以函数为主要载体的编程方式；</li> <li>使用<code>pure</code>，<code>immutable</code>的函数，代替改变原有状态的函数，减少作用域及副作用；</li> <li>将处理过程拆解成可复用的函数，利用<code>filter</code> <code>map</code> <code>reduce</code>减少中间变量和操作，语义更加清晰；</li> <li>使用链式，使得处理过程清晰，可读；</li> <li>使用<code>curry</code>化，把函数入参细分，去除不需要的参数；</li></ol> <p>在我看来 js的函数式编程 = <code>lambda</code> + <code>promise</code> + 箭头函数 + <code>curry</code> + ...</p> <h2 id="lambda-radma"><a href="#lambda-radma" aria-hidden="true" class="header-anchor">#</a> lambda - radma</h2> <p>虽然，相较于java的<code>lambda</code>，js的函数编程更鲜为人知。</p> <p>但从语法上来说，js比java跟适合进行函数式操作。</p> <p>js原生支持<code>.map</code> <code>.filter</code> <code>reduce</code></p> <p>其中 特别不推荐使用原生的<code>reduce</code> 其他两个很好用</p> <p>相对命令式，声明式的语法更简洁</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// 命令式</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapToList</span> <span class="token punctuation">(</span>map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>order<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 声明式</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">mapToList</span> <span class="token operator">=</span> maps <span class="token operator">=&gt;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>maps<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>value <span class="token operator">=&gt;</span> maps<span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>两者之间的差距是显而易见的</p> <p>尽量使用箭头函数 和 声明式 写法，对于减少代码量，是卓有成效的。</p> <p>原则上讲所有for循环，if-else，switch都可以用radma实现。</p> <p>举几个栗子</p> <h3 id="reduce-🎁"><a href="#reduce-🎁" aria-hidden="true" class="header-anchor">#</a> .reduce 🎁</h3> <h4 id="返回字符串"><a href="#返回字符串" aria-hidden="true" class="header-anchor">#</a> 返回字符串</h4> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// 命令式</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">paramsGenerate</span> <span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token string">'?'</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>values<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">{</span>params <span class="token operator">+=</span> <span class="token string">'&amp;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
      params <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>r<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>values<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> params<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 声明式</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">paramsGenerate</span> <span class="token operator">=</span> values <span class="token operator">=&gt;</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>acc<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">!</span>acc <span class="token operator">?</span> <span class="token string">'?'</span> <span class="token punctuation">:</span> <span class="token string">'&amp;'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>values<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> values<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>可以看到 声明式 写法，把上述一坨代码，变成一行来实现。<br>
这里使用了radma函数库，之所以不使用原生的<code>reduce</code>，是因为原生的<code>reduce</code>及其难用.</p> <p>首先<code>[].reduce()</code>会报错</p> <p>其次</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// expect return 1, but return { id: 1 }</span>
<span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>于是上面的<code>paramsGenerate</code>函数我们需要三次特殊处理，这还有什么便捷性可言。。。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">paramsGenerate</span> <span class="token operator">=</span> values <span class="token operator">=&gt;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> values<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> m<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>k <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> `<span class="token operator">?</span>$<span class="token punctuation">{</span>r<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>values<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>r<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&amp;</span>$<span class="token punctuation">{</span>m<span class="token punctuation">}</span><span class="token operator">=</span>$<span class="token punctuation">{</span>values<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">}</span>`<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="返回num"><a href="#返回num" aria-hidden="true" class="header-anchor">#</a> 返回Num</h4> <p>事实上，reduce最开始就是用来计算数组的和，这点对reduce而言，就是常规操作。<br>
比如说</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> totalAll <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> item<span class="token punctuation">.</span>qps<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> newData<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="返回object"><a href="#返回object" aria-hidden="true" class="header-anchor">#</a> 返回Object</h4> <p>这点我觉得可以算是一个亮点，对于懒癌晚期来说，可以说是福音了。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">listToMap</span> <span class="token operator">=</span> list <span class="token operator">=&gt;</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">:</span> item <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="filter"><a href="#filter" aria-hidden="true" class="header-anchor">#</a> .filter</h3> <p>.filter 主要替代for + if的操作，这个也是常规操作。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> tableId <span class="token operator">=</span> baseDataColumns<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> Number<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">===</span> item<span class="token punctuation">.</span>colId<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tableId<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> .map</h3> <p>.map 说起来，是一种特殊的.reduce，特殊在其返回的是Array</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">//半命令式</span>
 <span class="token keyword">const</span> tableAll <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>flowMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flowSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>temp<span class="token punctuation">.</span>tableAll<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>flowMap<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//声明式</span>
<span class="token keyword">const</span> tableAll <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> flowMap<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>flowMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span> <span class="token operator">!</span>flowSource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里为什么不用原生的.map，完全是强迫症使然。原生的map在这里因为前面进行了.filter处理，eslint会强剖你分成两行。</p> <p>为了让它变成一行，我就用了radma的.map</p> <p>其实radma还有很多很多有趣的语法，这里仅介绍了冰山一角。</p> <h3 id="cond"><a href="#cond" aria-hidden="true" class="header-anchor">#</a> .cond</h3> <p>替代swicth</p> <div class="language-jsx harmony line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> getStatusText <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">cond</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">'200000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token string">'新建'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">'200100'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token string">'待压测'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
  <span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">.</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token string">'错误'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="curry"><a href="#curry" aria-hidden="true" class="header-anchor">#</a> curry</h2> <p>何为curry：给定一个函数的部分参数，生成一个接受其他参数的新函数</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// 接收一个函数，并返回一个只接受一个参数的函数。</span>
<span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 柯里化一个参数，虽然似乎没什么用</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">curry2</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 柯里化两个参数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>secondArg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>firstArg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>firstArg<span class="token punctuation">,</span> secondArg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">curry3</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 柯里化三个参数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>middle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>curry化不管怎么样，在工程上可以让你方便的知道每个参数在函数里到底起到作用了没。</p> <h2 id="promise"><a href="#promise" aria-hidden="true" class="header-anchor">#</a> promise</h2> <p>promise 经常用于处理回调</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'flow/fetchFlowAll'</span><span class="token punctuation">,</span> groupId <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">goToFlow</span><span class="token punctuation">(</span>groupId<span class="token punctuation">)</span><span class="token punctuation">(</span>flowName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>dva支持的这个dispatch 之后.then的语法实际上用的是promise实现的。<a href="https://github.com/dvajs/dva/blob/master/packages/dva-core/src/createPromiseMiddleware.js" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// dva 源码</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">NAMESPACE_SEP</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./constants'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createPromiseMiddleware</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> next <span class="token operator">=&gt;</span> action <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> type <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEffect</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          __dva_resolve<span class="token punctuation">:</span> resolve<span class="token punctuation">,</span>
          __dva_reject<span class="token punctuation">:</span> reject<span class="token punctuation">,</span>
          <span class="token operator">...</span>action<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">isEffect</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>type <span class="token operator">||</span> <span class="token keyword">typeof</span> type <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>namespace<span class="token punctuation">]</span> <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token constant">NAMESPACE_SEP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> model <span class="token operator">=</span> app<span class="token punctuation">.</span>_models<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>m <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span>namespace <span class="token operator">===</span> namespace<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span>effects <span class="token operator">&amp;&amp;</span> model<span class="token punctuation">.</span>effects<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>在TAISHAN项目中，request封装判断超时的时候也用到了promise</p> <div class="language-jsx harmony line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">timeout</span> <span class="token operator">=</span> ms <span class="token operator">=&gt;</span> promise <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="箭头函数"><a href="#箭头函数" aria-hidden="true" class="header-anchor">#</a> 箭头函数</h2> <p>这个很简单，只是ES6的语法特性</p> <div class="language-jsx harmony line-numbers-mode"><pre class="language-jsx"><code><span class="token function">function1</span> <span class="token punctuation">(</span>params1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token comment">// 等价于</span>

<span class="token function-variable function">function1</span> <span class="token operator">=</span> params1 <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 如果 函数中只有return 还可以简化为</span>
<span class="token function-variable function">function1</span> <span class="token operator">=</span> params1 <span class="token operator">=&gt;</span> <span class="token operator">...</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="组件设计"><a href="#组件设计" aria-hidden="true" class="header-anchor">#</a> 组件设计</h2> <p>React 应用是由一个个独立的 Component 组成的，我们在拆分 Component 的过程中要尽量让每个 Component 专注做自己的事。</p> <p>一般来说，Component组件有两种设计：</p> <ol><li>Container Component</li> <li>Presentational Component</li></ol> <h3 id="container-component"><a href="#container-component" aria-hidden="true" class="header-anchor">#</a> Container Component</h3> <p>Container Component 一般指的是具有<code>监听数据行为</code>的组件，一般来说它们的职责是<code>绑定相关联的 model 数据</code>，以数据容器的角色包含其它子组件，通常在项目中表现出来的类型为：Layouts、Router Components 以及普通 Containers 组件。</p> <p>通常的书写形式为：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> PropTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// dva 的 connect 方法可以将组件和数据关联在一起</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva'</span><span class="token punctuation">;</span>

<span class="token comment">// 组件本身</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
MyComponent<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 监听属性，建立组件和数据的映射关系</span>
<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关联 model</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="presentational-component"><a href="#presentational-component" aria-hidden="true" class="header-anchor">#</a> Presentational Component</h3> <p>Presentational Component 的名称已经说明了它的职责，展示形组件，一般也称作：Dumb Component，它不会关联订阅 model 上的数据，而所需数据的传递则是通过 props 传递到组件内部。</p> <p>通常的书写形式：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> PropTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// 组件本身</span>
<span class="token comment">// 所需要的数据通过 Container Component 通过 props 传递下来</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
MyComponent<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 并不会监听数据</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> MyComponent<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="对比"><a href="#对比" aria-hidden="true" class="header-anchor">#</a> 对比</h3> <p>对组件分类，主要有两个好处：</p> <ol><li>让项目的数据处理更加集中；</li> <li>让组件高内聚低耦合，更加聚焦；</li></ol> <p>试想如果每个组件都去订阅数据 model，那么一方面组件本身跟 model 耦合太多，另一方面代码过于零散，到处都在操作数据，会带来后期维护的烦恼。</p> <p>除了写法上订阅数据的区别以外，在设计思路上两个组件也有很大不同。<br> <code>Presentational Component</code>是独立的纯粹的，这方面很好的例子，可以参考 <a href="http://ant.design/docs/react/introduce" target="_blank" rel="noopener noreferrer">ant.design UI组件的React实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ，每个组件跟业务数据并没有耦合关系，只是完成自己独立的任务，需要的数据通过 <code>props</code> 传递进来，需要操作的行为通过接口暴露出去。<br>
而 <code>Container Component</code> 更像是状态管理器，它表现为一个容器，订阅子组件需要的数据，组织子组件的交互逻辑和展示。</p> <h3 id="对modal的component不使用presentational的解释"><a href="#对modal的component不使用presentational的解释" aria-hidden="true" class="header-anchor">#</a> 对<code>Modal</code>的Component不使用<code>Presentational</code>的解释</h3> <ol><li>项目里面几乎所有的数据都存在Store,如果使用<code>Presentational</code>会造成，从父组件传递给子组件的参数过多，且对于复用组件而言，参数需要从所有引用处传递，使得代码显得冗余，繁冗，与redux初衷不符，这样额写法更像react最原始的架构；</li> <li>如果使用<code>Presentational</code>，必须保证不能使用connect，对于调用dispatch函数，都得在父组件处声明，使得回调函数不易实现；</li></ol> <p>更多的相关内容，可以看看Redux作者 Dan Abramov 的看法：</p> <ul><li><a href="https://github.com/reactjs/redux/issues/756#issuecomment-141683834" target="_blank" rel="noopener noreferrer">https://github.com/reactjs/redux/issues/756#issuecomment-141683834<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.231v4pdgr" target="_blank" rel="noopener noreferrer">https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.231v4pdgr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/" target="_blank" rel="noopener noreferrer">JS 函数式编程指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://ramdajs.com/" target="_blank" rel="noopener noreferrer">ramda<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>🍎</li> <li><a href="http://taobaofed.org/blog/2017/03/16/javascript-functional-programing/" target="_blank" rel="noopener noreferrer">淘宝前端FED<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/25/2018, 11:24:32 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pdd/dva.html" class="prev">
          Dva
        </a></span> <span class="next"><a href="/pdd/fetch.html">
          Fetch
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/11.c37c162c.js" defer></script><script src="/assets/js/app.02cca196.js" defer></script>
  </body>
</html>
